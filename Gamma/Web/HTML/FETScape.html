<!DOCTYPE html>
<html>

<head>
<title>FETScape</title>
<style type="text/css">
body {
    background-color: #FFF;
    margin: 30px;
    margin-top: 10px;
}
#contentContainer {
    width: 800px;
    height: 800px;
    border: 5px black solid;
    overflow: auto;
    background-color: #F2F2F2;
    cursor: pointer;
}
config_table {
    border-collapse: collapse;
}

</style>
</head>

<body oncontextmenu="return false;">

<svg  width="0" height="0">
<defs>
<g id="icon_close">
<path fill="#F44336" d="M42,37c0,2.762-2.238,5-5,5H11c-2.762,0-5-2.238-5-5V11c0-2.762,2.238-5,5-5h26c2.762,0,5,2.238,5,5V37z"/>
<g>

<rect x="21.914" y="12.065" transform="matrix(-0.7071 -0.7071 0.7071 -0.7071 23.7925 58.0271)" fill="#FFEBEE" width="4" height="24.042"/>

<rect x="22.064" y="11.726" transform="matrix(-0.7071 0.7071 -0.7071 -0.7071 57.9162 23.6334)" fill="#FFEBEE" width="4" height="24.171"/>
</g>
</g>
<g id="icon_maximize_old">
<path d="M15,4c-0.553,0-1,0.448-1,1s0.447,1,1,1h1.586l-3.293,3.293c-0.391,0.391-0.391,1.023,0,1.414  C13.488,10.902,13.744,11,14,11s0.512-0.098,0.707-0.293L18,7.414V9c0,0.552,0.447,1,1,1s1-0.448,1-1V4H15z"/><path d="M9.293,13.293L6,16.586V15c0-0.552-0.447-1-1-1s-1,0.448-1,1v4.999h0.996C5.004,19.999,9,20,9,20c0.552,0,1-0.448,1-1  s-0.447-1-1-1l-1.586,0l3.293-3.292c0.391-0.391,0.391-1.023,0-1.414S9.684,12.902,9.293,13.293z"/><path d="M7,12c0.552,0,1-0.448,1-1V8h3c0.553,0,1-0.448,1-1s-0.447-1-1-1H6.001L6,11C6,11.552,6.447,12,7,12z"/><path d="M17,12c-0.553,0-1,0.448-1,1v3h-3c-0.553,0-1,0.448-1,1s0.447,1,1,1h5v-5C18,12.448,17.553,12,17,12z"/>
</g>
<g id="icon_maximize">
<path fill="#2196F3" d="M42,37c0,2.762-2.238,5-5,5H11c-2.762,0-5-2.238-5-5V11c0-2.762,2.238-5,5-5h26c2.762,0,5,2.238,5,5V37z"/>
<path fill="#E1F5FE" d="M14,17v17h20V17H14z M32,32H16V22h16V32z"/>
</g>
<g id="icon_minimize_old">
<path d="M6.121,13c-0.553,0-1,0.448-1,1s0.447,1,1,1h1.465l-3.293,3.293c-0.391,0.391-0.391,1.023,0,1.414  C4.488,19.902,4.744,20,5,20s0.512-0.098,0.707-0.293l3.414-3.414V18c0,0.552,0.447,1,1,1S11,18.552,11,18v-5H6.121z"/><path d="M7,11c0.552,0,1-0.448,1-1V8h2c0.553,0,1-0.448,1-1s-0.447-1-1-1H6.001L6,10C6,10.552,6.447,11,7,11z"/><path d="M17,13c-0.553,0-1,0.448-1,1v2h-2c-0.553,0-1,0.448-1,1s0.447,1,1,1h4v-4C18,13.448,17.553,13,17,13z"/><path d="M18.293,4.293L15,7.586V6c0-0.552-0.447-1-1-1s-1,0.448-1,1v5h5c0.552,0,1-0.448,1-1s-0.447-1-1-1l-1.586,0l3.293-3.292  c0.391-0.391,0.391-1.023,0-1.414S18.684,3.902,18.293,4.293z"/>
</g>
<g id="icon_minimize">
<path fill="#2196F3" d="M42,37c0,2.762-2.238,5-5,5H11c-2.762,0-5-2.238-5-5V11c0-2.762,2.238-5,5-5h26c2.762,0,5,2.238,5,5V37z"/>
<rect x="14" y="30" fill="#E1F5FE" width="20" height="4"/>
</g>

<g id="icon_config">
<path fill="#607D8B" d="M39.6,27.2c0.1-0.7,0.2-1.4,0.2-2.2s-0.1-1.5-0.2-2.2l4.5-3.2c0.4-0.3,0.6-0.9,0.3-1.4L40,10.8  c-0.3-0.5-0.8-0.7-1.3-0.4l-5,2.3c-1.2-0.9-2.4-1.6-3.8-2.2l-0.5-5.5c-0.1-0.5-0.5-0.9-1-0.9h-8.6c-0.5,0-1,0.4-1,0.9l-0.5,5.5  c-1.4,0.6-2.7,1.3-3.8,2.2l-5-2.3c-0.5-0.2-1.1,0-1.3,0.4l-4.3,7.4c-0.3,0.5-0.1,1.1,0.3,1.4l4.5,3.2c-0.1,0.7-0.2,1.4-0.2,2.2  s0.1,1.5,0.2,2.2L4,30.4c-0.4,0.3-0.6,0.9-0.3,1.4L8,39.2c0.3,0.5,0.8,0.7,1.3,0.4l5-2.3c1.2,0.9,2.4,1.6,3.8,2.2l0.5,5.5  c0.1,0.5,0.5,0.9,1,0.9h8.6c0.5,0,1-0.4,1-0.9l0.5-5.5c1.4-0.6,2.7-1.3,3.8-2.2l5,2.3c0.5,0.2,1.1,0,1.3-0.4l4.3-7.4  c0.3-0.5,0.1-1.1-0.3-1.4L39.6,27.2z M24,35c-5.5,0-10-4.5-10-10c0-5.5,4.5-10,10-10c5.5,0,10,4.5,10,10C34,30.5,29.5,35,24,35z"/>
<path fill="#455A64" d="M24,13c-6.6,0-12,5.4-12,12c0,6.6,5.4,12,12,12s12-5.4,12-12C36,18.4,30.6,13,24,13z M24,30  c-2.8,0-5-2.2-5-5c0-2.8,2.2-5,5-5s5,2.2,5,5C29,27.8,26.8,30,24,30z"/>
</g>
<g id="icon_map">
<polygon points=" 0,0 0,0 8,0 13,0 14,8 14,16 14,24 14,32 14,40 14,48 15,56 15,64 15,72 15,80 15,88 15,96 16,96 16,104 16,112 16,120 16,128 16,136 17,144 17,152 17,160 17,168 18,176 18,184 18,192 18,200 19,208 19,216 19,224 19,232 20,240 20,248 20,256 21,264 21,272 21,280 22,288 22,296 22,304 23,312 23,320 24,325 24,328 24,336 24,344 25,352 25,360 26,368 26,376 27,384 27,392 28,400 29,408 29,416 30,424 31,432 31,440 32,440 32,448 33,456 34,464 35,472 36,480 36,488 38,496 39,504 40,508 40,512 41,520 42,528 44,536 45,544 47,552 48,554 48,560 50,568 52,576 54,584 56,587 57,592 59,600 62,608 64,612 65,616 68,624 72,631 72,632 76,640 80,646 80,648 85,656 88,658 91,664 96,669 97,672 104,678 105,680 112,685 114,688 120,692 124,696 128,698 136,703 136,704 144,707 152,711 152,712 160,715 168,718 171,720 176,721 184,724 192,726 195,728 200,728 208,731 216,733 224,734 228,736 232,736 240,738 248,739 256,741 264,742 272,743 273,744 280,744 288,745 296,746 304,747 312,748 320,749 328,750 336,751 342,752 344,752 352,752 360,753 368,754 376,754 384,755 392,755 400,756 408,757 416,757 424,758 432,758 440,758 448,759 456,759 456,760 464,760 472,760 480,761 488,761 496,761 504,762 512,762 520,762 528,763 536,763 544,763 552,764 560,764 568,764 576,764 584,765 592,765 600,765 608,765 616,766 624,766 632,766 640,766 648,767 656,767 664,767 672,767 680,767 684,768 688,768 696,768 704,768 712,768 720,768 728,768 736,769 744,769 752,769 760,769 768,769 776,769 784,769 784,776 784,784 784,784 776,784 768,784 760,784 752,784 744,784 736,784 728,784 720,784 712,784 704,784 696,784 688,784 680,784 672,784 664,784 656,784 648,784 640,784 632,784 624,784 616,784 608,784 600,784 592,784 584,784 576,784 568,784 560,784 552,784 544,784 536,784 528,784 520,784 512,784 504,784 496,784 488,784 480,784 472,784 464,784 456,784 448,784 440,784 432,784 424,784 416,784 408,784 400,784 392,784 384,784 376,784 368,784 360,784 352,784 344,784 336,784 328,784 320,784 312,784 304,784 296,784 288,784 280,784 272,784 264,784 256,784 248,784 240,784 232,784 224,784 216,784 208,784 200,784 192,784 184,784 176,784 168,784 160,784 152,784 144,784 136,784 128,784 120,784 112,784 104,784 96,784 88,784 80,784 72,784 64,784 56,784 48,784 40,784 32,784 24,784 16,784 8,784 0,784 0,784 0,776 0,768 0,760 0,752 0,744 0,736 0,728 0,720 0,712 0,704 0,696 0,688 0,680 0,672 0,664 0,656 0,648 0,640 0,632 0,624 0,616 0,608 0,600 0,592 0,584 0,576 0,568 0,560 0,552 0,544 0,536 0,528 0,520 0,512 0,504 0,496 0,488 0,480 0,472 0,464 0,456 0,448 0,440 0,432 0,424 0,416 0,408 0,400 0,392 0,384 0,376 0,368 0,360 0,352 0,344 0,336 0,328 0,320 0,312 0,304 0,296 0,288 0,280 0,272 0,264 0,256 0,248 0,240 0,232 0,224 0,216 0,208 0,200 0,192 0,184 0,176 0,168 0,160 0,152 0,144 0,136 0,128 0,120 0,112 0,104 0,96 0,88 0,80 0,72 0,64 0,56 0,48 0,40 0,32 0,24 0,16 0,8 " fill="#a50026"/>
<polygon points=" 13,0 16,0 24,0 32,0 36,0 37,8 37,16 37,24 38,32 38,40 39,48 39,56 40,64 40,64 40,72 40,80 41,88 41,96 42,104 42,112 43,120 43,128 44,136 45,144 45,152 46,160 46,168 47,176 48,184 48,184 48,192 49,200 50,208 50,216 51,224 52,232 52,240 53,248 54,256 55,264 56,269 56,272 57,280 58,288 59,296 60,304 61,312 62,320 63,328 64,334 64,336 65,344 66,352 67,360 69,368 70,376 72,384 72,384 73,392 75,400 76,408 78,416 80,424 80,424 81,432 83,440 85,448 87,456 88,456 90,464 92,472 94,480 96,484 97,488 100,496 102,504 104,507 105,512 109,520 112,526 112,528 116,536 120,544 120,544 124,552 128,559 128,560 133,568 136,572 138,576 144,584 144,584 150,592 152,594 156,600 160,604 163,608 168,612 171,616 176,620 180,624 184,627 189,632 192,634 200,640 200,640 208,645 211,648 216,650 224,655 225,656 232,659 240,664 240,664 248,667 256,671 257,672 264,674 272,678 276,680 280,681 288,684 296,686 300,688 304,689 312,691 320,694 327,696 328,696 336,698 344,700 352,702 360,704 360,704 368,705 376,707 384,709 392,710 400,712 400,712 408,713 416,714 424,716 432,717 440,718 448,719 450,720 456,720 464,721 472,722 480,724 488,724 496,725 504,726 512,727 514,728 520,728 528,729 536,730 544,731 552,731 560,732 568,733 576,734 584,734 592,735 600,736 600,736 608,736 616,737 624,737 632,738 640,739 648,739 656,740 664,740 672,741 680,741 688,742 696,742 704,743 712,743 720,744 720,744 728,744 736,744 744,745 752,745 760,746 768,746 776,746 784,747 784,752 784,760 784,768 784,769 776,769 768,769 760,769 752,769 744,769 736,769 728,768 720,768 712,768 704,768 696,768 688,768 684,768 680,767 672,767 664,767 656,767 648,767 640,766 632,766 624,766 616,766 608,765 600,765 592,765 584,765 576,764 568,764 560,764 552,764 544,763 536,763 528,763 520,762 512,762 504,762 496,761 488,761 480,761 472,760 464,760 456,760 456,759 448,759 440,758 432,758 424,758 416,757 408,757 400,756 392,755 384,755 376,754 368,754 360,753 352,752 344,752 342,752 336,751 328,750 320,749 312,748 304,747 296,746 288,745 280,744 273,744 272,743 264,742 256,741 248,739 240,738 232,736 228,736 224,734 216,733 208,731 200,728 195,728 192,726 184,724 176,721 171,720 168,718 160,715 152,712 152,711 144,707 136,704 136,703 128,698 124,696 120,692 114,688 112,685 105,680 104,678 97,672 96,669 91,664 88,658 85,656 80,648 80,646 76,640 72,632 72,631 68,624 65,616 64,612 62,608 59,600 57,592 56,587 54,584 52,576 50,568 48,560 48,554 47,552 45,544 44,536 42,528 41,520 40,512 40,508 39,504 38,496 36,488 36,480 35,472 34,464 33,456 32,448 32,440 31,440 31,432 30,424 29,416 29,408 28,400 27,392 27,384 26,376 26,368 25,360 25,352 24,344 24,336 24,328 24,325 23,320 23,312 22,304 22,296 22,288 21,280 21,272 21,264 20,256 20,248 20,240 19,232 19,224 19,216 19,208 18,200 18,192 18,184 18,176 17,168 17,160 17,152 17,144 16,136 16,128 16,120 16,112 16,104 16,96 15,96 15,88 15,80 15,72 15,64 15,56 14,48 14,40 14,32 14,24 14,16 14,8 " fill="#d73027"/>
<polygon points=" 36,0 40,0 48,0 56,0 61,0 62,8 63,16 63,24 64,24 64,32 65,40 66,48 66,56 67,64 68,72 69,80 69,88 70,96 71,104 72,108 72,112 73,120 74,128 74,136 75,144 76,152 77,160 78,168 79,176 80,176 80,184 82,192 83,200 84,208 85,216 86,224 88,231 88,232 89,240 90,248 92,256 93,264 94,272 96,277 96,280 97,288 99,296 101,304 102,312 104,316 104,320 106,328 108,336 110,344 112,349 112,352 114,360 116,368 119,376 120,378 121,384 123,392 126,400 128,404 129,408 132,416 134,424 136,426 138,432 141,440 144,446 144,448 148,456 151,464 152,464 155,472 159,480 160,480 164,488 168,494 168,496 173,504 176,507 178,512 184,519 184,520 189,528 192,530 195,536 200,540 202,544 208,550 209,552 216,558 216,560 224,566 224,568 232,574 233,576 240,581 242,584 248,587 253,592 256,594 264,599 264,600 272,605 276,608 280,610 288,615 289,616 296,619 303,624 304,624 312,628 319,632 320,632 328,635 336,639 337,640 344,642 352,645 357,648 360,648 368,651 376,654 379,656 384,657 392,659 400,662 404,664 408,664 416,667 424,669 432,671 433,672 440,673 448,675 456,677 464,679 467,680 472,680 480,682 488,684 496,685 504,687 506,688 512,689 520,690 528,691 536,693 544,694 552,695 552,696 560,697 568,698 576,699 584,700 592,701 600,702 607,704 608,704 616,705 624,706 632,707 640,708 648,708 656,709 664,710 672,711 674,712 680,712 688,713 696,714 704,714 712,715 720,716 728,717 736,717 744,718 752,719 759,720 760,720 768,720 776,721 784,721 784,728 784,736 784,744 784,747 776,746 768,746 760,746 752,745 744,745 736,744 728,744 720,744 720,744 712,743 704,743 696,742 688,742 680,741 672,741 664,740 656,740 648,739 640,739 632,738 624,737 616,737 608,736 600,736 600,736 592,735 584,734 576,734 568,733 560,732 552,731 544,731 536,730 528,729 520,728 514,728 512,727 504,726 496,725 488,724 480,724 472,722 464,721 456,720 450,720 448,719 440,718 432,717 424,716 416,714 408,713 400,712 400,712 392,710 384,709 376,707 368,705 360,704 360,704 352,702 344,700 336,698 328,696 327,696 320,694 312,691 304,689 300,688 296,686 288,684 280,681 276,680 272,678 264,674 257,672 256,671 248,667 240,664 240,664 232,659 225,656 224,655 216,650 211,648 208,645 200,640 200,640 192,634 189,632 184,627 180,624 176,620 171,616 168,612 163,608 160,604 156,600 152,594 150,592 144,584 144,584 138,576 136,572 133,568 128,560 128,559 124,552 120,544 120,544 116,536 112,528 112,526 109,520 105,512 104,507 102,504 100,496 97,488 96,484 94,480 92,472 90,464 88,456 87,456 85,448 83,440 81,432 80,424 80,424 78,416 76,408 75,400 73,392 72,384 72,384 70,376 69,368 67,360 66,352 65,344 64,336 64,334 63,328 62,320 61,312 60,304 59,296 58,288 57,280 56,272 56,269 55,264 54,256 53,248 52,240 52,232 51,224 50,216 50,208 49,200 48,192 48,184 48,184 47,176 46,168 46,160 45,152 45,144 44,136 43,128 43,120 42,112 42,104 41,96 41,88 40,80 40,72 40,64 40,64 39,56 39,48 38,40 38,32 37,24 37,16 37,8 " fill="#f46d43"/>
<polygon points=" 61,0 64,0 72,0 80,0 88,0 92,0 93,8 94,16 95,24 96,24 96,32 97,40 99,48 100,56 101,64 102,72 103,80 104,82 104,88 105,96 107,104 108,112 109,120 111,128 112,132 112,136 113,144 115,152 116,160 118,168 119,176 120,176 121,184 123,192 124,200 126,208 128,214 128,216 130,224 132,232 134,240 136,247 136,248 138,256 140,264 142,272 144,277 144,280 146,288 149,296 151,304 152,304 154,312 157,320 159,328 160,328 162,336 165,344 168,349 168,352 171,360 175,368 176,369 178,376 182,384 184,387 185,392 189,400 192,404 193,408 198,416 200,419 202,424 207,432 208,433 211,440 216,446 216,448 222,456 224,458 227,464 232,469 233,472 239,480 240,480 246,488 248,489 253,496 256,499 260,504 264,507 268,512 272,515 276,520 280,523 284,528 288,530 293,536 296,537 303,544 304,544 312,550 314,552 320,556 325,560 328,561 336,566 337,568 344,571 350,576 352,576 360,581 364,584 368,585 376,589 379,592 384,594 392,597 396,600 400,601 408,605 414,608 416,608 424,611 432,615 433,616 440,618 448,621 455,624 456,624 464,626 472,629 479,632 480,632 488,634 496,636 504,639 506,640 512,641 520,643 528,645 536,647 536,648 544,649 552,651 560,653 568,655 569,656 576,657 584,659 592,660 600,662 607,664 608,664 616,665 624,667 632,668 640,670 648,671 650,672 656,672 664,674 672,675 680,676 688,677 696,679 700,680 704,680 712,681 720,682 728,683 736,684 744,685 752,686 759,688 760,688 768,689 776,689 784,690 784,696 784,704 784,712 784,720 784,721 776,721 768,720 760,720 759,720 752,719 744,718 736,717 728,717 720,716 712,715 704,714 696,714 688,713 680,712 674,712 672,711 664,710 656,709 648,708 640,708 632,707 624,706 616,705 608,704 607,704 600,702 592,701 584,700 576,699 568,698 560,697 552,696 552,695 544,694 536,693 528,691 520,690 512,689 506,688 504,687 496,685 488,684 480,682 472,680 467,680 464,679 456,677 448,675 440,673 433,672 432,671 424,669 416,667 408,664 404,664 400,662 392,659 384,657 379,656 376,654 368,651 360,648 357,648 352,645 344,642 337,640 336,639 328,635 320,632 319,632 312,628 304,624 303,624 296,619 289,616 288,615 280,610 276,608 272,605 264,600 264,599 256,594 253,592 248,587 242,584 240,581 233,576 232,574 224,568 224,566 216,560 216,558 209,552 208,550 202,544 200,540 195,536 192,530 189,528 184,520 184,519 178,512 176,507 173,504 168,496 168,494 164,488 160,480 159,480 155,472 152,464 151,464 148,456 144,448 144,446 141,440 138,432 136,426 134,424 132,416 129,408 128,404 126,400 123,392 121,384 120,378 119,376 116,368 114,360 112,352 112,349 110,344 108,336 106,328 104,320 104,316 102,312 101,304 99,296 97,288 96,280 96,277 94,272 93,264 92,256 90,248 89,240 88,232 88,231 86,224 85,216 84,208 83,200 82,192 80,184 80,176 79,176 78,168 77,160 76,152 75,144 74,136 74,128 73,120 72,112 72,108 71,104 70,96 69,88 69,80 68,72 67,64 66,56 66,48 65,40 64,32 64,24 63,24 63,16 62,8 " fill="#fdae61"/>
<polygon points=" 92,0 96,0 104,0 112,0 120,0 128,0 129,0 130,8 132,16 133,24 134,32 136,38 136,40 137,48 139,56 140,64 142,72 144,79 144,80 145,88 147,96 149,104 150,112 152,116 152,120 154,128 156,136 158,144 160,150 160,152 162,160 164,168 166,176 168,180 168,184 171,192 173,200 176,207 176,208 178,216 181,224 183,232 184,232 186,240 189,248 192,255 192,256 194,264 198,272 200,276 201,280 204,288 207,296 208,296 211,304 214,312 216,314 218,320 222,328 224,331 226,336 230,344 232,346 234,352 239,360 240,361 243,368 248,374 248,376 253,384 256,387 258,392 264,399 264,400 269,408 272,411 275,416 280,421 281,424 288,431 288,432 294,440 296,441 301,448 304,450 309,456 312,458 316,464 320,467 324,472 328,474 333,480 336,482 342,488 344,489 352,495 352,496 360,502 362,504 368,508 372,512 376,514 384,519 384,520 392,525 396,528 400,530 408,535 408,536 416,540 422,544 424,544 432,549 436,552 440,553 448,557 452,560 456,561 464,565 469,568 472,569 480,572 487,576 488,576 496,579 504,582 506,584 512,585 520,588 528,591 528,592 536,594 544,597 550,600 552,600 560,602 568,605 576,607 576,608 584,610 592,612 600,614 603,616 608,617 616,619 624,621 632,623 633,624 640,625 648,627 656,629 664,631 666,632 672,633 680,634 688,636 696,638 704,639 704,640 712,641 720,643 728,644 736,646 744,647 745,648 752,649 760,650 768,651 776,653 784,654 784,656 784,664 784,672 784,680 784,688 784,690 776,689 768,689 760,688 759,688 752,686 744,685 736,684 728,683 720,682 712,681 704,680 700,680 696,679 688,677 680,676 672,675 664,674 656,672 650,672 648,671 640,670 632,668 624,667 616,665 608,664 607,664 600,662 592,660 584,659 576,657 569,656 568,655 560,653 552,651 544,649 536,648 536,647 528,645 520,643 512,641 506,640 504,639 496,636 488,634 480,632 479,632 472,629 464,626 456,624 455,624 448,621 440,618 433,616 432,615 424,611 416,608 414,608 408,605 400,601 396,600 392,597 384,594 379,592 376,589 368,585 364,584 360,581 352,576 350,576 344,571 337,568 336,566 328,561 325,560 320,556 314,552 312,550 304,544 303,544 296,537 293,536 288,530 284,528 280,523 276,520 272,515 268,512 264,507 260,504 256,499 253,496 248,489 246,488 240,480 239,480 233,472 232,469 227,464 224,458 222,456 216,448 216,446 211,440 208,433 207,432 202,424 200,419 198,416 193,408 192,404 189,400 185,392 184,387 182,384 178,376 176,369 175,368 171,360 168,352 168,349 165,344 162,336 160,328 159,328 157,320 154,312 152,304 151,304 149,296 146,288 144,280 144,277 142,272 140,264 138,256 136,248 136,247 134,240 132,232 130,224 128,216 128,214 126,208 124,200 123,192 121,184 120,176 119,176 118,168 116,160 115,152 113,144 112,136 112,132 111,128 109,120 108,112 107,104 105,96 104,88 104,82 103,80 102,72 101,64 100,56 99,48 97,40 96,32 96,24 95,24 94,16 93,8 " fill="#fee090"/>
<polygon points=" 129,0 136,0 144,0 152,0 160,0 168,0 172,0 173,8 175,16 176,17 177,24 179,32 181,40 183,48 184,50 185,56 187,64 189,72 191,80 192,81 193,88 196,96 198,104 200,109 200,112 203,120 205,128 208,135 208,136 210,144 213,152 216,159 216,160 219,168 221,176 224,181 224,184 227,192 231,200 232,202 234,208 237,216 240,221 240,224 244,232 248,239 248,240 251,248 255,256 256,256 259,264 263,272 264,272 267,280 272,287 272,288 276,296 280,301 281,304 285,312 288,315 290,320 295,328 296,328 301,336 304,340 306,344 312,351 312,352 318,360 320,362 324,368 328,372 330,376 336,382 337,384 344,391 344,392 351,400 352,400 358,408 360,409 366,416 368,417 374,424 376,425 383,432 384,432 392,439 392,440 400,446 401,448 408,453 411,456 416,459 421,464 424,465 432,471 432,472 440,477 443,480 448,482 455,488 456,488 464,493 468,496 472,498 480,502 481,504 488,507 496,511 496,512 504,516 511,520 512,520 520,524 527,528 528,528 536,532 544,535 544,536 552,539 560,542 562,544 568,546 576,549 581,552 584,552 592,556 600,559 602,560 608,562 616,564 624,567 624,568 632,570 640,573 648,575 648,576 656,578 664,580 672,583 674,584 680,585 688,587 696,590 702,592 704,592 712,594 720,596 728,598 733,600 736,600 744,602 752,604 760,606 766,608 768,608 776,610 784,611 784,616 784,624 784,632 784,640 784,648 784,654 776,653 768,651 760,650 752,649 745,648 744,647 736,646 728,644 720,643 712,641 704,640 704,639 696,638 688,636 680,634 672,633 666,632 664,631 656,629 648,627 640,625 633,624 632,623 624,621 616,619 608,617 603,616 600,614 592,612 584,610 576,608 576,607 568,605 560,602 552,600 550,600 544,597 536,594 528,592 528,591 520,588 512,585 506,584 504,582 496,579 488,576 487,576 480,572 472,569 469,568 464,565 456,561 452,560 448,557 440,553 436,552 432,549 424,544 422,544 416,540 408,536 408,535 400,530 396,528 392,525 384,520 384,519 376,514 372,512 368,508 362,504 360,502 352,496 352,495 344,489 342,488 336,482 333,480 328,474 324,472 320,467 316,464 312,458 309,456 304,450 301,448 296,441 294,440 288,432 288,431 281,424 280,421 275,416 272,411 269,408 264,400 264,399 258,392 256,387 253,384 248,376 248,374 243,368 240,361 239,360 234,352 232,346 230,344 226,336 224,331 222,328 218,320 216,314 214,312 211,304 208,296 207,296 204,288 201,280 200,276 198,272 194,264 192,256 192,255 189,248 186,240 184,232 183,232 181,224 178,216 176,208 176,207 173,200 171,192 168,184 168,180 166,176 164,168 162,160 160,152 160,150 158,144 156,136 154,128 152,120 152,116 150,112 149,104 147,96 145,88 144,80 144,79 142,72 140,64 139,56 137,48 136,40 136,38 134,32 133,24 132,16 130,8 " fill="#ffffbf"/>
<polygon points=" 172,0 176,0 184,0 192,0 200,0 208,0 216,0 223,0 224,2 225,8 228,16 230,24 232,28 232,32 235,40 237,48 240,54 240,56 243,64 245,72 248,77 248,80 251,88 254,96 256,99 257,104 260,112 263,120 264,120 266,128 270,136 272,140 273,144 277,152 280,158 280,160 284,168 288,175 288,176 291,184 295,192 296,192 299,200 304,207 304,208 308,216 312,222 312,224 317,232 320,236 321,240 326,248 328,249 331,256 336,262 336,264 342,272 344,274 347,280 352,286 353,288 358,296 360,297 364,304 368,308 370,312 376,318 377,320 384,327 384,328 390,336 392,337 397,344 400,346 405,352 408,354 412,360 416,362 420,368 424,370 429,376 432,378 437,384 440,385 446,392 448,393 456,399 456,400 464,406 465,408 472,412 475,416 480,419 486,424 488,425 496,430 497,432 504,436 509,440 512,441 520,447 521,448 528,452 533,456 536,457 544,462 547,464 552,466 560,471 561,472 568,475 576,479 576,480 584,484 591,488 592,488 600,492 608,495 608,496 616,499 624,503 625,504 632,506 640,510 643,512 648,513 656,516 663,520 664,520 672,523 680,526 684,528 688,529 696,532 704,535 706,536 712,537 720,540 728,543 729,544 736,546 744,548 752,551 754,552 760,553 768,555 776,558 781,560 784,560 784,568 784,576 784,584 784,592 784,600 784,608 784,611 776,610 768,608 766,608 760,606 752,604 744,602 736,600 733,600 728,598 720,596 712,594 704,592 702,592 696,590 688,587 680,585 674,584 672,583 664,580 656,578 648,576 648,575 640,573 632,570 624,568 624,567 616,564 608,562 602,560 600,559 592,556 584,552 581,552 576,549 568,546 562,544 560,542 552,539 544,536 544,535 536,532 528,528 527,528 520,524 512,520 511,520 504,516 496,512 496,511 488,507 481,504 480,502 472,498 468,496 464,493 456,488 455,488 448,482 443,480 440,477 432,472 432,471 424,465 421,464 416,459 411,456 408,453 401,448 400,446 392,440 392,439 384,432 383,432 376,425 374,424 368,417 366,416 360,409 358,408 352,400 351,400 344,392 344,391 337,384 336,382 330,376 328,372 324,368 320,362 318,360 312,352 312,351 306,344 304,340 301,336 296,328 295,328 290,320 288,315 285,312 281,304 280,301 276,296 272,288 272,287 267,280 264,272 263,272 259,264 256,256 255,256 251,248 248,240 248,239 244,232 240,224 240,221 237,216 234,208 232,202 231,200 227,192 224,184 224,181 221,176 219,168 216,160 216,159 213,152 210,144 208,136 208,135 205,128 203,120 200,112 200,109 198,104 196,96 193,88 192,81 191,80 189,72 187,64 185,56 184,50 183,48 181,40 179,32 177,24 176,17 175,16 173,8 " fill="#e0f3f8"/>
<polygon points=" 223,0 224,0 232,0 240,0 248,0 256,0 264,0 272,0 280,0 286,0 288,4 289,8 292,16 295,24 296,25 298,32 301,40 304,45 305,48 308,56 311,64 312,64 315,72 319,80 320,82 322,88 326,96 328,99 330,104 334,112 336,115 338,120 342,128 344,130 346,136 350,144 352,145 355,152 359,160 360,160 364,168 368,173 369,176 374,184 376,186 379,192 384,199 384,200 389,208 392,210 395,216 400,222 401,224 406,232 408,233 412,240 416,244 418,248 424,254 425,256 431,264 432,264 438,272 440,273 445,280 448,282 452,288 456,291 460,296 464,299 467,304 472,308 475,312 480,316 484,320 488,323 492,328 496,331 501,336 504,338 510,344 512,345 519,352 520,352 528,358 529,360 536,364 539,368 544,371 550,376 552,377 560,382 561,384 568,388 572,392 576,394 584,399 584,400 592,404 597,408 600,409 608,414 610,416 616,419 623,424 624,424 632,428 638,432 640,433 648,437 652,440 656,441 664,445 668,448 672,449 680,453 684,456 688,457 696,461 701,464 704,464 712,468 719,472 720,472 728,475 736,478 738,480 744,482 752,485 758,488 760,488 768,491 776,494 779,496 784,497 784,504 784,512 784,520 784,528 784,536 784,544 784,552 784,560 784,560 781,560 776,558 768,555 760,553 754,552 752,551 744,548 736,546 729,544 728,543 720,540 712,537 706,536 704,535 696,532 688,529 684,528 680,526 672,523 664,520 663,520 656,516 648,513 643,512 640,510 632,506 625,504 624,503 616,499 608,496 608,495 600,492 592,488 591,488 584,484 576,480 576,479 568,475 561,472 560,471 552,466 547,464 544,462 536,457 533,456 528,452 521,448 520,447 512,441 509,440 504,436 497,432 496,430 488,425 486,424 480,419 475,416 472,412 465,408 464,406 456,400 456,399 448,393 446,392 440,385 437,384 432,378 429,376 424,370 420,368 416,362 412,360 408,354 405,352 400,346 397,344 392,337 390,336 384,328 384,327 377,320 376,318 370,312 368,308 364,304 360,297 358,296 353,288 352,286 347,280 344,274 342,272 336,264 336,262 331,256 328,249 326,248 321,240 320,236 317,232 312,224 312,222 308,216 304,208 304,207 299,200 296,192 295,192 291,184 288,176 288,175 284,168 280,160 280,158 277,152 273,144 272,140 270,136 266,128 264,120 263,120 260,112 257,104 256,99 254,96 251,88 248,80 248,77 245,72 243,64 240,56 240,54 237,48 235,40 232,32 232,28 230,24 228,16 225,8 224,2 " fill="#abd9e9"/>
<polygon points=" 286,0 288,0 296,0 304,0 312,0 320,0 328,0 336,0 344,0 352,0 360,0 366,0 368,3 370,8 373,16 376,20 377,24 381,32 384,36 385,40 390,48 392,51 394,56 398,64 400,65 403,72 407,80 408,80 412,88 416,93 417,96 422,104 424,106 427,112 432,119 432,120 437,128 440,131 443,136 448,142 448,144 454,152 456,154 460,160 464,164 466,168 472,175 472,176 478,184 480,185 485,192 488,195 491,200 496,204 498,208 504,214 505,216 512,223 512,224 520,231 520,232 527,240 528,240 535,248 536,248 543,256 544,256 552,263 552,264 560,271 560,272 568,278 569,280 576,285 578,288 584,292 588,296 592,298 598,304 600,305 608,311 608,312 616,317 618,320 624,323 629,328 632,329 640,335 641,336 648,340 652,344 656,346 664,351 664,352 672,356 677,360 680,361 688,366 690,368 696,371 703,376 704,376 712,380 717,384 720,385 728,389 732,392 736,393 744,397 747,400 752,402 760,406 763,408 768,410 776,413 780,416 784,417 784,424 784,432 784,440 784,448 784,456 784,464 784,472 784,480 784,488 784,496 784,497 779,496 776,494 768,491 760,488 758,488 752,485 744,482 738,480 736,478 728,475 720,472 719,472 712,468 704,464 701,464 696,461 688,457 684,456 680,453 672,449 668,448 664,445 656,441 652,440 648,437 640,433 638,432 632,428 624,424 623,424 616,419 610,416 608,414 600,409 597,408 592,404 584,400 584,399 576,394 572,392 568,388 561,384 560,382 552,377 550,376 544,371 539,368 536,364 529,360 528,358 520,352 519,352 512,345 510,344 504,338 501,336 496,331 492,328 488,323 484,320 480,316 475,312 472,308 467,304 464,299 460,296 456,291 452,288 448,282 445,280 440,273 438,272 432,264 431,264 425,256 424,254 418,248 416,244 412,240 408,233 406,232 401,224 400,222 395,216 392,210 389,208 384,200 384,199 379,192 376,186 374,184 369,176 368,173 364,168 360,160 359,160 355,152 352,145 350,144 346,136 344,130 342,128 338,120 336,115 334,112 330,104 328,99 326,96 322,88 320,82 319,80 315,72 312,64 311,64 308,56 305,48 304,45 301,40 298,32 296,25 295,24 292,16 289,8 288,4 " fill="#74add1"/>
<polygon points=" 366,0 368,0 376,0 384,0 392,0 400,0 408,0 416,0 424,0 432,0 440,0 448,0 456,0 464,0 472,0 480,0 480,0 485,8 488,11 490,16 495,24 496,24 501,32 504,36 506,40 512,47 512,48 517,56 520,59 523,64 528,70 529,72 535,80 536,80 541,88 544,91 547,96 552,101 554,104 560,110 560,112 567,120 568,120 574,128 576,129 581,136 584,138 588,144 592,147 596,152 600,155 603,160 608,164 611,168 616,172 619,176 624,180 628,184 632,187 636,192 640,195 645,200 648,202 654,208 656,209 663,216 664,216 672,223 672,224 680,229 682,232 688,236 692,240 696,242 703,248 704,248 712,254 713,256 720,260 724,264 728,266 736,271 736,272 744,277 747,280 752,282 759,288 760,288 768,293 772,296 776,298 784,303 784,304 784,312 784,320 784,328 784,336 784,344 784,352 784,360 784,368 784,376 784,384 784,392 784,400 784,408 784,416 784,417 780,416 776,413 768,410 763,408 760,406 752,402 747,400 744,397 736,393 732,392 728,389 720,385 717,384 712,380 704,376 703,376 696,371 690,368 688,366 680,361 677,360 672,356 664,352 664,351 656,346 652,344 648,340 641,336 640,335 632,329 629,328 624,323 618,320 616,317 608,312 608,311 600,305 598,304 592,298 588,296 584,292 578,288 576,285 569,280 568,278 560,272 560,271 552,264 552,263 544,256 543,256 536,248 535,248 528,240 527,240 520,232 520,231 512,224 512,223 505,216 504,214 498,208 496,204 491,200 488,195 485,192 480,185 478,184 472,176 472,175 466,168 464,164 460,160 456,154 454,152 448,144 448,142 443,136 440,131 437,128 432,120 432,119 427,112 424,106 422,104 417,96 416,93 412,88 408,80 407,80 403,72 400,65 398,64 394,56 392,51 390,48 385,40 384,36 381,32 377,24 376,20 373,16 370,8 368,3 " fill="#4575b4"/>
<polygon points=" 480,0 488,0 496,0 504,0 512,0 520,0 528,0 536,0 544,0 552,0 560,0 568,0 576,0 584,0 592,0 600,0 608,0 616,0 624,0 632,0 640,0 648,0 656,0 664,0 672,0 680,0 688,0 696,0 704,0 712,0 720,0 728,0 736,0 744,0 752,0 760,0 768,0 776,0 784,0 784,0 784,8 784,16 784,24 784,32 784,40 784,48 784,56 784,64 784,72 784,80 784,88 784,96 784,104 784,112 784,120 784,128 784,136 784,144 784,152 784,160 784,168 784,176 784,184 784,192 784,200 784,208 784,216 784,224 784,232 784,240 784,248 784,256 784,264 784,272 784,280 784,288 784,296 784,303 776,298 772,296 768,293 760,288 759,288 752,282 747,280 744,277 736,272 736,271 728,266 724,264 720,260 713,256 712,254 704,248 703,248 696,242 692,240 688,236 682,232 680,229 672,224 672,223 664,216 663,216 656,209 654,208 648,202 645,200 640,195 636,192 632,187 628,184 624,180 619,176 616,172 611,168 608,164 603,160 600,155 596,152 592,147 588,144 584,138 581,136 576,129 574,128 568,120 567,120 560,112 560,110 554,104 552,101 547,96 544,91 541,88 536,80 535,80 529,72 528,70 523,64 520,59 517,56 512,48 512,47 506,40 504,36 501,32 496,24 495,24 490,16 488,11 485,8 " fill="#313695"/>
<polyline points="36,0 37,8 37,16 37,24 38,32 38,40 39,48 39,56 40,64 40,64 40,72 40,80 41,88 41,96 42,104 42,112 43,120 43,128 44,136 45,144 45,152 46,160 46,168 47,176 48,184 48,184 48,192 49,200 50,208 50,216 51,224 52,232 52,240 53,248 54,256 55,264 56,269 56,272 57,280 58,288 59,296 60,304 61,312 62,320 63,328 64,334 64,336 65,344 66,352 67,360 69,368 70,376 72,384 72,384 73,392 75,400 76,408 78,416 80,424 80,424 81,432 83,440 85,448 87,456 88,456 90,464 92,472 94,480 96,484 97,488 100,496 102,504 104,507 105,512 109,520 112,526 112,528 116,536 120,544 120,544 124,552 128,559 128,560 133,568 136,572 138,576 144,584 144,584 150,592 152,594 156,600 160,604 163,608 168,612 171,616 176,620 180,624 184,627 189,632 192,634 200,640 200,640 208,645 211,648 216,650 224,655 225,656 232,659 240,664 240,664 248,667 256,671 257,672 264,674 272,678 276,680 280,681 288,684 296,686 300,688 304,689 312,691 320,694 327,696 328,696 336,698 344,700 352,702 360,704 360,704 368,705 376,707 384,709 392,710 400,712 400,712 408,713 416,714 424,716 432,717 440,718 448,719 450,720 456,720 464,721 472,722 480,724 488,724 496,725 504,726 512,727 514,728 520,728 528,729 536,730 544,731 552,731 560,732 568,733 576,734 584,734 592,735 600,736 600,736 608,736 616,737 624,737 632,738 640,739 648,739 656,740 664,740 672,741 680,741 688,742 696,742 704,743 712,743 720,744 720,744 728,744 736,744 744,745 752,745 760,746 768,746 776,746 784,747 " stroke-width="3" fill="none" stroke="black"/>
<polyline points="36,0 " stroke-width="3" fill="none" stroke="black"/>
<polyline points="784,747 776,746 768,746 760,746 752,745 744,745 736,744 728,744 720,744 720,744 712,743 704,743 696,742 688,742 680,741 672,741 664,740 656,740 648,739 640,739 632,738 624,737 616,737 608,736 600,736 600,736 592,735 584,734 576,734 568,733 560,732 552,731 544,731 536,730 528,729 520,728 514,728 512,727 504,726 496,725 488,724 480,724 472,722 464,721 456,720 450,720 448,719 440,718 432,717 424,716 416,714 408,713 400,712 400,712 392,710 384,709 376,707 368,705 360,704 360,704 352,702 344,700 336,698 328,696 327,696 320,694 312,691 304,689 300,688 296,686 288,684 280,681 276,680 272,678 264,674 257,672 256,671 248,667 240,664 240,664 232,659 225,656 224,655 216,650 211,648 208,645 200,640 200,640 192,634 189,632 184,627 180,624 176,620 171,616 168,612 163,608 160,604 156,600 152,594 150,592 144,584 144,584 138,576 136,572 133,568 128,560 128,559 124,552 120,544 120,544 116,536 112,528 112,526 109,520 105,512 104,507 102,504 100,496 97,488 96,484 94,480 92,472 90,464 88,456 87,456 85,448 83,440 81,432 80,424 80,424 78,416 76,408 75,400 73,392 72,384 72,384 70,376 69,368 67,360 66,352 65,344 64,336 64,334 63,328 62,320 61,312 60,304 59,296 58,288 57,280 56,272 56,269 55,264 54,256 53,248 52,240 52,232 51,224 50,216 50,208 49,200 48,192 48,184 48,184 47,176 46,168 46,160 45,152 45,144 44,136 43,128 43,120 42,112 42,104 41,96 41,88 40,80 40,72 40,64 40,64 39,56 39,48 38,40 38,32 37,24 37,16 37,8 " stroke-width="3" fill="none" stroke="black"/>
<path fill="#F57C00" d="M40,41H8c-2.2,0-4-1.8-4-4V11c0-2.2,1.8-4,4-4h32c2.2,0,4,1.8,4,4v26C44,39.2,42.2,41,40,41z"/>
</g>
</defs>
</svg>
<div id="ServerContent"></div>

<!--
<div id="Xpos">0</div>
<div id="Ypos">0</div>
<div id="Button">0</div>
-->
<table>
<tr><td><div id="Debug_Message"></div></td></tr>
<tr><td>
<div id="container">
<svg id="WorkAreaSVG" width="700px" height="700px" xmlns = "http://www.w3.org/2000/svg">
<foreignObject x="50" y="50" width="200" height="150">
<body xmlns="http://www.w3.org/1999/xhtml">
<input type="text"/>
<input type="text"/>
</body>
</foreignObject>
</svg>
</div>
</td><td valign='top' align='center'><div style="config_table"><table><tr><td>
<div id="Configurations"></div></td></tr><tr><td><div id="SchematicContainer"></div></td></tr></table></div>
<script>
var debug_mode=0;
function msg(T) {
    var definitions=document.getElementById("Debug_Message");
    definitions.innerHTML=T;
}
//var container = document.querySelector("#contentContainer");
var TILE=35;
var schema_window;
var screen_dividerX,screen_dividerY;
var config_default_window_height=500;
var configuration_window_index=-1;
var container = document.getElementById("container");
var scroll=0; 
var drag=0;
var startX=0,startY=0,endX=0,endY=0;
var FSWindowList=[];
var FSMinimizedWindowList=[];
var resizing_screen=0;
var resizing_screenX=0;
var resizing_screenY=0;
var resizing=0;
var resizing_window;
var dragging_window=-1;
var dragging_windowX,dragging_windowY;
var panning_window_minX,panning_window_minY,panning_window_maxX,panning_window_maxY;
var window_children = ["window_title", "icon_close", "icon_maximize" , "icon_minimize" , "icon_config" , "title_text" , "content"];
var selection_box;
var id_unique=0;
var SVG=document.getElementById("WorkAreaSVG");
var config_minimized_line_y=0;
var config_frame=9;
var config_rubric_height=TILE/1.618;
var config_rubric_width=3*config_rubric_height;
var HoverMessage="";
var hover_bg;
var hover_object;
var xhr; 
var XMLparser;
var XMLData;
var SVGNS="http://www.w3.org/2000/svg";
var SPEC={Adc:"35",CMRR:"",PSRR:"",BW:"",PM:"",Rout:"",Cin:"",Area:"",Power:"",Cload:"",Rin:""};
var PlotXAxis=Object.keys(SPEC)[0];
var PlotYAxis=Object.keys(SPEC)[1];
var PlotCAxis=Object.keys(SPEC)[2];
var PlotType="Pareto Front";
var SVGclip=function(id,x,y,w,h) {
    var SVGObj= document.createElementNS(SVGNS,"clipPath");
    SVGObj.id=id+"_clip";
    var Rect= document.createElementNS(SVGNS,"rect");
    Rect.x.baseVal.value=x;
    Rect.y.baseVal.value=y;
    Rect.width.baseVal.value=w;
    Rect.height.baseVal.value=h;
    Rect.style.stroke="black";
    Rect.style.fill="none";
    Rect.id=id+"_inner_clip_rect";
    SVGObj.appendChild(Rect);
    SVG.appendChild(SVGObj);
    return SVGObj;
}
var htmlHeight=0;
var htmlWidth=0;
var SVGhtml=function(id,x,y,w,h,c){
    var g=document.createElementNS("http://www.w3.org/2000/svg", 'g'); //Create a g element in SVG's namespace
    g.setAttribute("x",0); //Set g dat
    g.setAttribute("y",0); //Set g dat
    var newNode = document.createElementNS("http://www.w3.org/2000/svg", 'foreignObject'); //Create a rect in SVG's namespace
    newNode.setAttribute("x",x); //Set rect data
    newNode.setAttribute("y",y); //Set rect data
    newNode.setAttribute("width",w); //Set rect data
    newNode.setAttribute("height",h); //Set rect data
    var newDiv = document.createElement('div');     
    var divIdName = "div_1";
    newDiv.setAttribute('id',divIdName);
    newDiv.innerHTML = c;
    newNode.appendChild(newDiv);    
    g.appendChild(newNode);
    SVG.appendChild(g);
    htmlHeight=newDiv.clientHeight;
    htmlWidth=newDiv.clientWidth;
    return newNode;
}
var SVGrect=function(id,x,y,w,h){
    var SVGObj= document.createElementNS(SVGNS,"rect");
    SVGObj.x.baseVal.value=x;
    SVGObj.y.baseVal.value=y;
    SVGObj.width.baseVal.value=w;
    SVGObj.height.baseVal.value=h;
    SVGObj.style.stroke="black";
    SVGObj.style.fill="none";
    SVGObj.id=id;
    SVG.appendChild(SVGObj);
    return SVGObj;
}
var SVGcirc=function(id,x,y,r){
    var SVGObj= document.createElementNS(SVGNS,"circle");
    SVGObj.setAttributeNS(null,"cx",x);
    SVGObj.setAttributeNS(null,"cy",y);
    SVGObj.setAttributeNS(null,"r",r);
    SVGObj.style.stroke="black";
    SVGObj.style.fill="none";
    SVGObj.id=id;
    SVG.appendChild(SVGObj);
    return SVGObj;
}
var SVGline=function(id,x1,y1,x2,y2){
    var SVGObj= document.createElementNS(SVGNS,"line");
    SVGObj.setAttributeNS(null,"x1",x1);
    SVGObj.setAttributeNS(null,"y1",y1);
    SVGObj.setAttributeNS(null,"x2",x2);
    SVGObj.setAttributeNS(null,"y2",y2);
    SVGObj.style.stroke="black";
    SVGObj.id=id;
    SVG.appendChild(SVGObj);
    return SVGObj;
}
var SVGgraphline=function(id,x1,y1,x2,y2,color){
    var SVGObj= document.createElementNS(SVGNS,"line");
    SVGObj.setAttributeNS(null,"x1",x1);
    SVGObj.setAttributeNS(null,"y1",y1);
    SVGObj.setAttributeNS(null,"x2",x2);
    SVGObj.setAttributeNS(null,"y2",y2);
    SVGObj.setAttributeNS(null,"stroke-dasharray","2,2");
    SVGObj.style.stroke=color;
    SVGObj.id=id;
    SVG.appendChild(SVGObj);
    return SVGObj;
}
var SVGnum=function(id,t,x,y,f=16,Wlimit=-1,Hlimit=-1) {
    var SVGObj=document.createElementNS(SVGNS,"text");
    if (isNaN(x)) x=0;
    if (isNaN(y)) y=0;
    if (isNaN(f)) f=16;
    SVGObj.style.fill="black";
    SVGObj.setAttributeNS(null,"x",x);
    SVGObj.setAttributeNS(null,"y",y);
    SVGObj.setAttributeNS(null,"font-size",f);
    SVGObj.setAttributeNS(null,"font-family","Deja Vu Sans Mono");
    SVGObj.textContent=t;
    SVGObj.id=id;
    SVG.appendChild(SVGObj);
    var bBox = SVGObj.getBBox();
    if (((Wlimit!=-1)||(Hlimit!=-1))&&(bBox.width>0)&&(bBox.height>0)) {
        var a=1;
        var e=0;
        if ((Wlimit!=-1)&&(bBox.width>Wlimit)) {
            a=1.0*Wlimit/bBox.width;
            e=x-a*x;
        }
        var d=1;
        var f=0;
        if ((Hlimit!=-1)&&(bBox.height>Hlimit)) {
            d=1.0*Hlimit/bBox.height;
            f=y-d*y;
        }
        SVGObj.setAttributeNS(null,"transform","matrix("+a+",0,0,"+d+","+e+","+f+")");
    }
    return SVGObj;
}
var SVGtext=function(id,t,x,y,f=16,Wlimit=-1,Hlimit=-1) {
    var SVGObj=document.createElementNS(SVGNS,"text");
    if (isNaN(x)) x=0;
    if (isNaN(y)) y=0;
    if (isNaN(f)) f=16;
    SVGObj.style.fill="black";
    SVGObj.setAttributeNS(null,"x",x);
    SVGObj.setAttributeNS(null,"y",y);
    SVGObj.setAttributeNS(null,"font-size",f);
    SVGObj.setAttributeNS(null,"font-family","URW Bookman L");
    SVGObj.textContent=t;
    SVGObj.id=id;
    SVG.appendChild(SVGObj);
    var bBox = SVGObj.getBBox();
    if (((Wlimit!=-1)||(Hlimit!=-1))&&(bBox.width>0)&&(bBox.height>0)) {
        var a=1;
        var e=0;
        if ((Wlimit!=-1)&&(bBox.width>Wlimit)) {
            a=1.0*Wlimit/bBox.width;
            e=x-a*x;
        }
        var d=1;
        var f=0;
        if ((Hlimit!=-1)&&(bBox.height>Hlimit)) {
            d=1.0*Hlimit/bBox.height;
            f=y-d*y;
        }
        SVGObj.setAttributeNS(null,"transform","matrix("+a+",0,0,"+d+","+e+","+f+")");
    }
    return SVGObj;
}
var SVGuse=function(id,x,y,w,h,c,o){
    var xlink = 'http://www.w3.org/1999/xlink';
    var SVGObj=document.createElementNS(SVGNS,"use");
    var m="matrix(" + w/o + ",0,0," + h/o + "," + x + "," + y + ")";
    SVGObj.setAttributeNS(null,"transform",m);
    SVGObj.setAttributeNS(xlink,"href","#"+c);
    SVGObj.id=id;
    SVG.appendChild(SVGObj);
    return SVGObj;
}
// Convert floating-pont number to metric prefix notation
function eng(F) {
    var sign="";
    if (F==0) return("0");
    if (F<0) {
        sign="-";
        F=-F;
    }
    var index=Math.trunc(Math.log10(F)/3);
    if ((index<-8)||(index>8)) {
        return(sign+F);
    }
    F=Math.trunc(10*F/Math.pow(1000,index))/10;
    var suffix;
    if (index<0) {
        suffix=["","m","u","n","p","f","a","z","y"][-index];
    } else {
        suffix=["","K","M","G","T","P","E","Z","Y"][index];
    }
    return(sign+F+suffix);
}
var window_types=["HeatMap","Sweep","Schema","Search","Config"];
var topology_list=["cs_nmos","cs_pmos","diffpair_nmos","diffpair_pmos","diffpair_output_nmos","diffpair_output_pmos","folded_cascode_op_amp"];
var topology_scale={cs_nmos:0.8,cs_pmos:0.8,diffpair_nmos:0.6,diffpair_pmos:0.6,diffpair_output_nmos:0.4,diffpair_output_pmos:0.4,folded_cascode_op_amp:0.23};
var current_topology=topology_list[0];
var technology_list=["TSMC 40nm","TSMC 180nm"];
var current_technology=technology_list[0];
var unit_Map={Adc:"dB",CMRR:"dB",PSRR:"dB",BW:"Hz",PM:"deg",Rout:"Ohm",Cin:"F",Area:"(um)^2",Power:"W",Cload:"F",Rin:"Ohm"};
var property_quality={Adc:1,CMRR:1,PSRR:1,BW:1,PM:1,Rout:-1,Cin:-1,Area:-1,Power:-1};  //1 means more-is-better, -1 means less-is-better

var circuit_list=[];
var circuit_table_list=[];
var SCHEMA=[];
var ajax_ready=1;
var pallete=["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"];
var colors={window_title:4,window_bg:6,window_hover_bg:4,pivot_bg:5};
function PopulateServerGraphics() {
    if (xhr.readyState!=4) return;
    if (xhr.status!=200) return;
    var definitions=document.getElementById("ServerContent");
    definitions.innerHTML=xhr.responseText;
    Redraw();
    ajax_ready=1;
}
function PopulateServerTopology() {
    var record_list=XMLData.getElementsByTagName("Topology");
    var i,j,l,k;
    for (i=0;i<record_list.length;i++) {
        var W={id:"",topo:"",selected:0,table_index:0};
        for (j=0;j<record_list[i].attributes.length;j++) {
            var att=record_list[i].attributes[j].nodeName;
            W[att]=record_list[i].getAttribute(att);
        }
        var schema_record=record_list[i].getElementsByTagName("SchemaDef")[0];
        var schema_row_list=schema_record.getElementsByTagName("SchemaRow");
        var schema_list=[];
        var row_list=[];
        for (j=0;j<schema_row_list.length;j++) {
            var schema_row=schema_row_list[j];
            var block_list=schema_row.getElementsByTagName("SchemaBlock");
            row_list=[];
            for (l=0;l<block_list.length;l++) {
                var block=block_list[l];
                var B={type:"blank",flip:"0",rotate:"0",name:""};
                for (k=0;k<block.attributes.length;k++) {
                    var att=block.attributes[k].nodeName;
                    B[att]=block.getAttribute(att);
                }
                row_list.push(B);
            }
            schema_list.push(row_list);
        }
	W.rows=schema_list;
        SCHEMA.push(W);
    }
}
function PopulateServerData() {
    if (xhr.readyState!=4) return;
    if (xhr.status!=200) return;
    var ServerData=xhr.responseText;
    XMLData=XMLparser.parseFromString(ServerData,"text/xml");
    // Get windows and numerical data
    var window_type_index=0;
    var cascade_coord=TILE*3;
    var record_list=XMLData.getElementsByTagName("Circuit");
    var i,j;
    for (i=0;i<record_list.length;i++) {
        var W={id:"",topo:"",selected:0,table_index:0};
        for (j=0;j<record_list[i].attributes.length;j++) {
            var att=record_list[i].attributes[j].nodeName;
            W[att]=record_list[i].getAttribute(att);
        }
        circuit_list.push(W);
    }
    for (window_type_index=0;window_type_index<window_types.length;window_type_index++) {
        var window_type=window_types[window_type_index];
        var window_list=XMLData.getElementsByTagName(window_type);
        var i,j;
        var defaultX=100;
        var defaultY=100;
        for (i=0;i<window_list.length;i++) {
            windowXML=window_list[i];
            var newid=windowXML.getAttribute("id");
            var found=0;
            for (j=0;j<FSWindowList.length;j++) {
                var V=FSWindowList[j];
                if (V.id==newid) {
                    found=1;
                    break;
                }
            }
            for (j=0;j<FSMinimizedWindowList.length;j++) {
                var V=FSMinimizedWindowList[j];
                if (V.id==newid) {
                    found=1;
                    break;
                }
            }
            if (found==0) {
                var W={id:"", title:"",x:0,y:0,w:500,h:500,content:"",state:"normal",type:"",minX:0,maxX:0,minY:0,maxY:0};
                W.x=100+cascade_coord;
                W.y=cascade_coord;
                cascade_coord+=TILE;
                W.type=window_type;
                for (j=0;j<windowXML.attributes.length;j++) {
                    var att=windowXML.attributes[j].nodeName;
                    W[att]=windowXML.getAttribute(att);
                }
                FSWindowList.push(W);
                var index=FSWindowList.length-1;
                eval("Init"+window_type+"("+index+")");
            }
        }
    }
    GetServerData("/graphics.html","Graphics");
    Redraw();
}
function GetServerData(url,target) {
    xhr.open ("GET", url, true); 
    eval("xhr.onreadystatechange = PopulateServer"+target); 
    xhr.send(null); 
}
function PositionWindow(i,x,y,w,h) {
    var W=FSWindowList[i];
    W.x=x;
    W.y=y;
    W.w=w;
    W.h=h;
    FSWindowList.splice(i, 1);
    FSWindowList.push(W);
    Redraw();
}    
container.addEventListener("mousedown", getClickPositionDown, false);
container.addEventListener("mouseup", getClickPositionUp, false);
container.addEventListener("mousemove", getMove, false);
container.addEventListener("scroll", updateScroll, false);
function getChar(event) {
    if (event.which == null) {
        return String.fromCharCode(event.keyCode) // IE
    } else if (event.which!=0 && event.charCode!=0) {
        return String.fromCharCode(event.which)   // the rest
    } else {
        return null // special key
    }
}
container.onkeydown=function(e) {
    var c=getChar(e);
    msg(c);
}

function SetFocus(i) {
    var W=FSWindowList[i];
    FSWindowList.splice(i,1);
    FSWindowList.push(W);
}
function getClickPositionDown(e) {
    var parentPosition = getPosition(e.currentTarget);
    startX = e.clientX - parentPosition.x ;
    startY = e.clientY - parentPosition.y ;
    if (debug_mode) {
        var xpos=document.getElementById("Xpos");
        xpos.innerHTML=startX;
        var ypos=document.getElementById("Ypos");
        ypos.innerHTML=startY;
        var bpos=document.getElementById("Button");
        bpos.innerHTML=e.buttons;
    }
    drag=0;
    dragging_window=-1;
    if ((startX>screen_dividerX-TILE)&&(startX<screen_dividerX+TILE)&&(startY>screen_dividerY-TILE)&&(startY<screen_dividerY+TILE)) {
        resizing_screen=1;
        resizing_screenX=screen_dividerX;
        resizing_screenY=screen_dividerY;
        return;
    }
    for (i = 0; i< FSMinimizedWindowList.length;i++) {
        if (startX<0) continue;
        if (startX>TILE) continue;
        if (startY<config_minimized_line_y+i*TILE) continue;
        if (startY>config_minimized_line_y+(i+1)*TILE) continue;
        var W=FSMinimizedWindowList[i];
        W.state="normal";
        FSMinimizedWindowList.splice(i,1);
        FSWindowList.push(W);
        Redraw();
        return;
    }
    for (i = FSWindowList.length-1; i>=0; i--) { 
        var W=FSWindowList[i];
        if (startX<W.x) continue;
        if (startX>W.x+W.w) continue;
        if (startY<W.y) continue;
        if (startY>W.y+W.h+TILE) continue;
        if ((startY>W.y+W.h)&&(startX>W.x+W.w-TILE)) {
            resizing_window=i;
            resizingW=W.w;
            resizingH=W.h;
            resizing=1;
            return;
        }
        if ((startX>W.x+TILE)&&(startX<W.x+W.w-3*TILE)&&(startY<W.y+TILE)) {
            drag=1;
            dragging_window=FSWindowList.length-1;
            dragging_windowX=W.x;
            dragging_windowY=W.y;
            FSWindowList.splice(i,1);
            FSWindowList.push(W);
            Redraw();
            return;
        }   
        if ((startX>W.x+W.w-TILE)&&(startY<W.y+TILE)&&(W.type!="Search")) {
            var index;
            FSWindowList.splice(i,1);
            Redraw();
            return;
        }
        if (W.type=="Config") return;
        if ((startX>W.x)&&(startX<W.x+TILE)&&(startY<W.y+TILE)) {
            eval("ClickConfig"+W.type+"("+i+")");
            Redraw();
            return;
        }
        if (W.type!="Search") {
            if ((startX<W.x+W.w-TILE)&&(startX>W.x+W.w-2*TILE)&&(startY<W.y+TILE)) {
                if (W.state=="maximized") {
                    PositionWindow(i,W.x,W.y,config_default_window_height,config_default_window_height);
                    W.state="normal";
                } else {
                    PositionWindow(i,0,0,screen.availHeight*3/4,screen.availHeight*3/4);
                    W.state="maximized";
                }
                FSWindowList[i]=W;
                return;
            }
            if ((startX<W.x+W.w-2*TILE)&&(startX>W.x+W.w-3*TILE)&&(startY<W.y+TILE)) {
                W.state="minimized";
                FSMinimizedWindowList.push(W);
                FSWindowList.splice(i,1);
                Redraw();
                return;	
            }
        }
        // Pass click to the window
        eval("MouseDown"+W.type+"("+i+","+startX+","+startY+","+e.buttons+")");
        return;
    }
}
function ClickConfigConfig(i) {}
function MouseOverConfig(i) {}
function MouseDownConfig(i) {}

function ClickConfigSchema(i) {}
function MouseOverSchema(i) {}
function MouseDownSchema(i) {}
function DrawSchemaMinimized(i) {}
function DrawSchema(i) {
    var W=FSWindowList[i];
    var j,k,l;
    for (j=0;j<SCHEMA.length;j++) {
        if (W.content!=SCHEMA[j].name) continue;
	var num_of_rows=SCHEMA[j].rows.length;
	var num_of_cols=SCHEMA[j].rows[0].length;
	var tile_width=(W.w-2*TILE)/num_of_cols;
	var tile_height=(W.h-2*TILE)/num_of_rows;
	for (k=0;k<SCHEMA[j].rows.length;k++) for (l=0;l<SCHEMA[j].rows[k].length;l++) {
	    B=SCHEMA[j].rows[k][l];
	    SVGuse(W.id+"block"+k+","+l,B.type,W.x+TILE+l*tile_width,W.y+2*TILE+k*tile_height,tile_width,tile_height);
	}
    }
}

function openConfig(id,c,title="Edit Specifications") {
    var j;
    for (j=0;j<FSWindowList.length;j++) {
        if (FSWindowList[j].id!=id) continue;
        FSWindowList[j].title=title;
        FSWindowList[j].content=c;
        return;
    }
    // Must be a new window
    var W={id:id,title:title,x:300,y:0,w:500,h:500,content:c,state:"normal",type:"Config"};
    FSWindowList.push(W);
}
function ClickConfigHeatMap(i) {
    var W=FSWindowList[i];
    openConfig(FSWindowList[i].id+"_config_hm","","HeatMap Configurations!");
}
function ClickConfigSweep(i) {
    var W=FSWindowList[i];
    openConfig(FSWindowList[i].id+"_config_sweep","","Sweep Configurations!");
}
function OpenNewPlot() {
    var content="<body xmlns=\"http://www.w3.org/1999/xhtml\">";
    content+="<select name=\"SelectPlotType\" onchange=\"PlotTypeChanged()\">"
    content+="<option selected=\""+PlotType+"\">"+PlotType+"</option>";
    if (PlotType!="Pareto Front") content+="<option value=\"Pareto Front\">Pareto Front</option>";
    if (PlotType!="1D Sweep") content+="<option value=\"1D Sweep\">1D Sweep</option>";
    if (PlotType!="2D Heat Map") content+="<option value=\"2D Heat Map\">2D Heat Map</option>";
    content+="</select>";
    content+="<select name=\"SpecInput_topology\" onchange=\"TopologyChanged()\">"
    content+="<option selected=\""+current_topology+"\">"+current_topology+"</option>";
    for (j=0;j<topology_list.length;j++) {
        if (topology_list[j]!=current_topology) content+="<option value=\""+topology_list[j]+"\">"+topology_list[j]+"</option>";
    }
    content+="</select>"
    content+="<select name=\"SpecInput_technology\" onchange=\"TechnologyChanged()\">"
    content+="<option selected=\""+current_technology+"\">"+current_technology+"</option>";
    for (j=0;j<technology_list.length;j++) {
        if (technology_list[j]!=current_technology) content+="<option value=\""+technology_list[j]+"\">"+technology_list[j]+"</option>";
    }
    content+="</select>"
    content+="<table>";
    content+="<tr><td>X Axis:</td>";
    content+="<td colspan=\"2\">";
    content+="<select name=\"SelectXAxisForPlot\" onchange=\"PlotXChanged()\">"
    content+="<option selected=\""+PlotXAxis+"\">"+PlotXAxis+"</option>";
    for (j=0;j<Object.keys(SPEC).length;j++) {
        var property=Object.keys(SPEC)[j];
        content+="<option value=\""+property+"\">"+property+"</option>";
    }
    content+="</select></td></tr>"
    content+="<tr><td>Y Axis:</td><td colspan=\"2\" >";
    content+="<select name=\"SelectYAxisForPlot\" onchange=\"PlotYChanged()\">"
    content+="<option selected=\""+PlotYAxis+"\">"+PlotYAxis+"</option>";
    for (j=0;j<Object.keys(SPEC).length;j++) {
        var property=Object.keys(SPEC)[j];
        content+="<option value=\""+property+"\">"+property+"</option>";
    }
    content+="</select></td></tr>"
    if (PlotType=="2D Heat Map") {
        content+="<tr><td>Colors:</td><td colspan=\"2\">";
        content+="<select name=\"SelectCAxisForPlot\" onchange=\"PlotCChanged()\">"
        content+="<option selected=\""+PlotCAxis+"\">"+PlotCAxis+"</option>";
        for (j=0;j<Object.keys(SPEC).length;j++) {
            var property=Object.keys(SPEC)[j];
            content+="<option value=\""+property+"\">"+property+"</option>";
        }
        content+="</select></td></tr>"
    }
    content+="<tr><td colspan=\"2\"><div id=\"WarningPlot\"></div></td></tr>"
    content+="<tr><td></td><td colspan=\"2\"><button onclick=\"SendPlot()\">Plot "+PlotType+"</button></td></tr>"
    content+="</table>"
    content+="</body>";
    if (PlotType=="Pareto Front") {
        openConfig("ConfigPlot",content,"New Pareto Front:");
    } else {
        openConfig("ConfigPlot",content,"New "+PlotType+" for Circuit #"+pivot_circuit_index+":");
    }
    Redraw();
}    
function OpenConfigSearch() {
    var j;
    var content="<table>"
    for (j=0;j<Object.keys(SPEC).length;j++) {
        var property=Object.keys(SPEC)[j];
        content+="<tr><td>";
        content+=property;
        content+="</td><td>";
        content+="<input type=\"text\" name=\"SpecInput_"+property+"\" onchange=\"SpecChanged('"+property+"')\" value=\""+SPEC[property]+"\"/>";
        content+="</td><td>";
        content+="["+unit_Map[property]+"]";
        content+="</td></tr>";
    }
    openConfig("ConfigSpec",content);
    Redraw();	
}    
function ClickConfigSearch(i) {
    var W=FSWindowList[i];
    OpenConfigSearch();
}
function SpecChanged(property) {
    SPEC[property]=document.getElementsByName("SpecInput_"+property)[0].value;
    OpenConfigSearch();
}
function SendPlot() {
    alert(PlotType);
}
function PlotXChanged() {
    PlotXAxis=document.getElementsByName("SelectXAxisForPlot")[0].value;
    warn_window=document.getElementById("WarningPlot");
    if (PlotXAxis==PlotYAxis) {
        warn_window.innerHTML="<font color=\"red\">Warning: Plot axes are the same!</font>";
    } else {
        warn_window.innerHTML="";
    }
}
function PlotYChanged() {
    PlotYAxis=document.getElementsByName("SelectYAxisForPlot")[0].value;
    warn_window=document.getElementById("WarningPlot");
    if (PlotXAxis==PlotYAxis) {
        warn_window.innerHTML="<font color=\"red\">Warning: Plot axes are the same!</font>";
    } else {
        warn_window.innerHTML="";
    }
}
function PlotCChanged() {
    PlotCAxis=document.getElementsByName("SelectCAxisForPlot")[0].value;
    warn_window=document.getElementById("WarningPlot");
    if (PlotXAxis==PlotCAxis) {
        warn_window.innerHTML="<font color=\"red\">Warning: Plot axes are the same!</font>";
    } else {
        warn_window.innerHTML="";
    }
}
function PlotTypeChanged() {
    PlotType=document.getElementsByName("SelectPlotType")[0].value;
    var j,pivot=0;
    for (j=0;j<circuit_table_list.length;j++) if (circuit_table_list[j]!=-1) pivot=1;
    if (!pivot) PlotType="Pareto Front";
    OpenNewPlot();
    warn_window=document.getElementById("WarningPlot");
    if (!pivot) {
        warn_window.innerHTML="<font color=\"red\">Error: No no circuits in the search trail yet!<br>Start with a Pareto front.</font>";
    } else {
        warn_window.innerHTML="";
    }
}
function TechnologyChanged() {
    current_technology=document.getElementsByName("SpecInput_technology")[0].value;
    OpenNewPlot();
}
function TopologyChanged() {
    current_topology=document.getElementsByName("SpecInput_topology")[0].value;
    OpenNewPlot();
}
function UpperGraphBoundary(i) {
    var W=FSWindowList[i];
    return W.y+2*TILE;
}
function LowerGraphBoundary(i) {
    var W=FSWindowList[i];
    return W.y+2*TILE+W.h*(config_frame-2)/config_frame;
}
function LeftGraphBoundary(i) {
    var W=FSWindowList[i];
    return W.x+W.w/config_frame;
}
function RightGraphBoundary(i) {
    var W=FSWindowList[i];
    return W.x+W.w*(config_frame-1)/config_frame;
}
function GraphWidth(i) {
    var W=FSWindowList[i];
    return W.w*(config_frame-2)/config_frame;
}
function GraphHeight(i) {
    var W=FSWindowList[i];
    return W.h*(config_frame-2)/config_frame;
}
function MouseDownHeatMap(i,X,Y,B) {
    var W=FSWindowList[i];
    if ((X>LeftGraphBoundary(i))&&(X<RightGraphBoundary(i))&&(Y>UpperGraphBoundary(i))&&(Y<LowerGraphBoundary(i))) {
        MouseDownGraph(i,X,Y,B);
        return;
    }
    if ((X>LeftGraphBoundary(i))&&(X<RightGraphBoundary(i))&&(Y>LowerGraphBoundary(i))) {
        MouseDownXRuler(i,X,Y,B);
        return;
    }
    if ((X<LeftGraphBoundary(i))&&(Y>UpperGraphBoundary(i))&&(Y<LowerGraphBoundary(i))) {
        MouseDownYRuler(i,X,Y,B);
        return;
    }
}
function MouseDownSweep(i,X,Y,B) {
    var W=FSWindowList[i];
    if (B==1) {
        var id=SenseClosestCircuit(i);
        if (id==-1) return;
        var j;
        for (j=0;j<circuit_list.length;j++) {
            if (circuit_list[j].id==id) {
                if (circuit_list[j].selected==0) {
                    var k;
                    var n=1;
                    circuit_list[j].table_index=-1;
                    for (k=0;k<circuit_table_list.length;k++) if (circuit_table_list[k]==-1) {
                        circuit_list[j].table_index=k;
                        circuit_table_list[k]=j;
                        break;
                    }	
                    if (circuit_list[j].table_index==-1) {
                        circuit_list[j].table_index=circuit_table_list.length;
                        circuit_table_list.push(j);
                    }
                }
                circuit_list[j].selected=1; 
            }
        }  
        Redraw();
        return;
    }
    if ((X>LeftGraphBoundary(i))&&(X<RightGraphBoundary(i))&&(Y>UpperGraphBoundary(i))&&(Y<LowerGraphBoundary(i))) {
        MouseDownGraph(i,X,Y,B);
        return;
    }
    if ((X>LeftGraphBoundary(i))&&(X<RightGraphBoundary(i))&&(Y>LowerGraphBoundary(i))) {
        MouseDownXRuler(i,X,Y,B);
        return;
    }
    if ((X<LeftGraphBoundary(i))&&(Y>UpperGraphBoundary(i))&&(Y<LowerGraphBoundary(i))) {
        MouseDownYRuler(i,X,Y,B);
        return;
    }
}
var panning_window;
var panningXY=0;
var panningX=0;
var panningY=0;
var zooming_window;
var zoomingXY=0;
var zoomingX=0;
var zoomingY=0;
var zoom_box;
var pivot_circuit_index=0;
function MouseDownSearch(i,X,Y,B) {
    if (B!=1) return;
    var W=FSWindowList[i];
    var j=0;
    if ((X>W.x+W.w-TILE)&&(Y<W.y+TILE)) {
        OpenNewPlot();
        return;
    }
    for (i=0;i<circuit_table_list.length;i++) {
        if (circuit_table_list[i]==-1) continue;
        j++;
        if (X<W.x+config_rubric_width*(j+1)-config_rubric_height/2) continue;
        if (X>W.x+config_rubric_width*(j+1)) continue;
        if (Y<W.y+TILE) continue;
        if (Y>W.y+TILE+config_rubric_height/2) continue;
        circuit_list[circuit_table_list[i]].selected=0;
        circuit_table_list[i]=-1;
        if (pivot_circuit_index==i) {
            var k;
            for (k=0;k<circuit_table_list.length;k++) {
                if (circuit_table_list[k]==-1) continue;
                pivot_circuit_index=k;
                break;
            }	
        }    
        Redraw();
        return;
    }
    j=0;
    for (i=0;i<circuit_table_list.length;i++) {
        if (circuit_table_list[i]==-1) continue;
        j++;
        if (X<W.x+config_rubric_width*j) continue;
        if (X>W.x+config_rubric_width*(j+1)) continue;
        if (Y<W.y+TILE) continue;
        pivot_circuit_index=i;
        if (configuration_window_index!=-1) OpenNewPlot();
        Redraw();
        return;
    }
    if (PlotType!="Pareto Front") {
        for (j=0;j<FSWindowList.length;j++) {
            if (FSWindowList[j].id!="ConfigPlot") continue;
            FSWindowList[j].title="New "+PlotType+" for Circuit #"+pivot_circuit_index;
            Redraw();
        }
    }
}
function MouseDownGraph(i,X,Y,B) {
    var W=FSWindowList[i];
    if (B&2) {
        zoomingXY=1;
        zooming_window=i;
        zoom_box=SVGrect("zoom_box",X,Y,0,0);
        return;
    }
    if (B&4) {
        panning_window_minX=W.ShowWindowMinX;
        panning_window_maxX=W.ShowWindowMaxX;
        panning_window_minY=W.ShowWindowMinY;
        panning_window_maxY=W.ShowWindowMaxY;
        panningXY=1;
        panning_window=i;
        return;
    }
}
function MouseDownXRuler(i,X,Y,B) {
    var W=FSWindowList[i];
    if (B&2) {
        zoomingX=1;
        zooming_window=i;
        zoom_box=SVGrect("zoom_box",X,W.y+TILE,0,W.h);
        return;
    }
    if (B&4) {
        panning_window_minX=W.ShowWindowMinX;
        panning_window_maxX=W.ShowWindowMaxX;
        panningX=1;
        panning_window=i;
        return;
    }
}
function MouseDownYRuler(i,X,Y,B) {
    var W=FSWindowList[i];
    if (B&2) {
        zoomingY=1;
        zooming_window=i;
        zoom_box=SVGrect("zoom_box",W.x,Y,W.w,0);
        return;
    }
    if (B&4) {
        panning_window_minY=W.ShowWindowMinY;
        panning_window_maxY=W.ShowWindowMaxY;
        panningY=1;
        panning_window=i;
        return;
    }
}
function Redraw() {
    while (SVG.lastChild) SVG.removeChild(SVG.lastChild);
    SVG.setAttribute("width",screen_dividerX);
    if (current_topology!="") {
        var content="<svg height=\""+screen_dividerY+"\" width=\""+screen_dividerY+"\">";
        content+="<rect x=\"0\" y=\"0\" stroke=\"black\" fill=\"none\" width=\""+screen_dividerY+"\" height=\""+screen_dividerY+"\"/> ";
        content+="<use x=\"0\" y=\"0\" xlink:href=\"#schema_";
        content+=current_topology+"\" transform=\"scale(";
        var scale=screen_dividerY*topology_scale[current_topology]/400;
        content+=scale+")\"/> </svg>";
        schema_window.innerHTML=content;
    }	
    for (i = 0; i < FSMinimizedWindowList.length; i++) eval("Draw"+FSMinimizedWindowList[i].type+"Minimized("+i+")");
    for (i = 0; i < FSWindowList.length; i++) {
        W=FSWindowList[i];
        var focus=0;
        if (i==FSWindowList.length-1) focus=1;
        var window_title=SVGrect(W.id+"window_title",W.x,W.y,W.w,TILE);
        if (focus) {
            window_title.style.fill=pallete[colors.window_title+1]; 
        } else {
            window_title.style.fill=pallete[colors.window_title];
        }    
        if (W.type!="Search") {
            var window_bg=SVGrect(W.id+"window_bg",W.x,W.y+TILE,W.w,W.h);
            if (focus) {
                window_bg.style.fill=pallete[colors.window_bg-1]; 
            } else {
                window_bg.style.fill=pallete[colors.window_bg];
            }
            SVGuse(W.id+"icon_close",W.x+W.w-TILE,W.y,TILE,TILE,"icon_close",48.0);
            if (W.type!="Config") SVGuse(W.id+"icon_maximize",W.x+W.w-2*TILE,W.y,TILE,TILE,"icon_maximize",48.0);
            if (W.type!="Config") SVGuse(W.id+"icon_minimize",W.x+W.w-3*TILE,W.y,TILE,TILE,"icon_minimize",48.0);
        } else {
            SVGuse(W.id+"icon_map",W.x+W.w-TILE,W.y,TILE,TILE,"icon_map",800.0);
        }
        if (W.type!="Config") SVGuse(W.id+"icon_config",W.x,W.y,TILE,TILE,"icon_config",48.0);
        var title_text=SVGtext(W.id+"title_text",W.title,W.x+TILE+(W.w-4*TILE)/2,W.y+TILE-5,TILE*3/4,W.w-5*TILE);
        title_text.setAttributeNS(null,"text-anchor","middle");
        eval("Draw"+W.type+"("+i+")");
    }	 
    hover_bg=SVGrect("hover_bg",endX+TILE,endY+TILE-16,10,10);
    hover_bg.style.fill=pallete[colors.window_hover_bg];
    hover_object=SVGtext("hover_object",HoverMessage,endX+TILE,endY+TILE);
    var bbox=hover_object.getBBox();
    hover_bg.setAttribute("x",bbox.x-bbox.width*0.05);
    hover_bg.setAttribute("y",bbox.y);
    hover_bg.setAttribute("width",bbox.width*1.1);
    hover_bg.setAttribute("height",bbox.height*1.1);
}
function DrawSearch(index) {
    var W=FSWindowList[index];
    var i,j,k;
    var num_of_selected=0;
    for (i=0;i<circuit_list.length;i++) if (circuit_list[i].selected) num_of_selected++;
    W.w=config_rubric_width*(num_of_selected+1);
    var spec_entries=0
    for (i=0;i<Object.keys(SPEC).length;i++) if (Object.keys(SPEC)[i]!="") spec_entries++;
    W.h=(spec_entries+1)*config_rubric_height;
    FSWindowList[index]=W;
    // Draw table header
    var rubric=SVGrect(W.id+"SpecHead",W.x,W.y+TILE,config_rubric_width,config_rubric_height).style.fill=pallete[colors.window_bg];
    j=1;
    for (i=0;i<circuit_table_list.length;i++) {
        if (circuit_table_list[i]==-1) continue;
        var bg=SVGrect(W.id+"CircuitHead"+j,W.x+config_rubric_width*j,W.y+TILE,config_rubric_width,config_rubric_height);
        SVGuse(W.id+"icon_close"+j,W.x+config_rubric_width*(j+1)-config_rubric_height/2,W.y+TILE,config_rubric_height/2,config_rubric_height/2,"icon_close",48.0);
        SVGrect(W.id+"icon_close"+j,W.x+config_rubric_width*(j+1)-config_rubric_height/2,W.y+TILE,config_rubric_height/2,config_rubric_height/2);
        if (pivot_circuit_index==i) {
            bg.style.fill=pallete[colors.pivot_bg];
        } else {
            bg.style.fill=pallete[colors.window_bg];
        }
        rubric=SVGtext(W.id+"CircuitHeadText"+j,i,W.x+config_rubric_width*(j+0.5),W.y+TILE+config_rubric_height-config_rubric_height/4,config_rubric_height*3/4,config_rubric_width,config_rubric_height);
        var pass="green";
        for (k=0;k<Object.keys(SPEC).length;k++) {
            var property=Object.keys(SPEC)[k];
            if (SPEC[property]=="") continue;
            var val=circuit_list[circuit_table_list[i]][property];
            if (property_quality[property]*val<property_quality[property]*SPEC[property]) {
                pass="red";
                break;
            }
        }
        rubric.setAttributeNS(null,"style","fill:"+pass);
        rubric.setAttributeNS(null,"text-anchor","middle");
        j++;
    }
    var row;
    i=0;
    for (row=0;row<Object.keys(SPEC).length;row++) {
        var property=Object.keys(SPEC)[row];
        if (SPEC[property]=="") continue;
        SVGrect(W.id+"SpecHead"+i,W.x,W.y+TILE+config_rubric_height*(i+1),config_rubric_width,config_rubric_height).style.fill=pallete[colors.window_bg];
        var unit=unit_Map[property];
        var op=">";
        if (property_quality[property]==-1) op="<";
        var label=property+op+eng(SPEC[property])+unit;
        SVGnum(W.id+"SpecHeadText"+i,label,W.x,W.y+TILE+config_rubric_height*(i+2)-config_rubric_height/4,config_rubric_height*3/4,config_rubric_width*8/9,config_rubric_height);
        k=1;
        for (j=0;j<circuit_table_list.length;j++) {
            if (circuit_table_list[j]==-1) continue;
            var bg=SVGrect(W.id+"SpecHead"+i,W.x+k*config_rubric_width,W.y+TILE+config_rubric_height*(i+1),config_rubric_width,config_rubric_height);
            if (pivot_circuit_index==j) {
                bg.style.fill=pallete[colors.pivot_bg];
            } else {
                bg.style.fill=pallete[colors.window_bg];
            }
            var val=circuit_list[circuit_table_list[j]][property];
            var rubric=SVGnum(W.id+"SpecHeadText"+i,eng(val),W.x+(k+0.5)*config_rubric_width,W.y+TILE+config_rubric_height*(i+2)-config_rubric_height/4,config_rubric_height*3/4,config_rubric_width,config_rubric_height);
            rubric.setAttributeNS(null,"style","fill:green");
            if (property_quality[property]*val<property_quality[property]*SPEC[property]) {
                rubric.setAttributeNS(null,"style","fill:red");
            }
            rubric.setAttributeNS(null,"text-anchor","middle");
            k++;
        }
        i++;
    }
}
function DrawSearchMinimized(i) {
    SVGrect(W.id+"rect",0,config_minimized_line_y+i*TILE,TILE,TILE);
}
function InitSchema(i) {}

function InitHeatMap(i) {
    var W=FSWindowList[i];
    W.xtitle=W.xaxis+"   ["+unit_Map[W.xaxis]+"]";
    W.ytitle=W.yaxis+"   ["+unit_Map[W.yaxis]+"]";
    var spanX=parseFloat(W.maxX)-parseFloat(W.minX);
    var spanY=parseFloat(W.maxY)-parseFloat(W.minY);
    W.ShowWindowMinX=parseFloat(W.minX);
    W.ShowWindowMaxX=parseFloat(W.maxX);
    W.ShowWindowMinY=parseFloat(W.minY);
    W.ShowWindowMaxY=parseFloat(W.maxY);
    FSWindowList[i]=W;
}
function InitSearch(i) {
}

var graph_rootX;
var graph_width;
var graph_rootY;
var graph_height;
function DrawHeatMap(i) {
    var contentpx=785;
    var W=FSWindowList[i];
    var hm=SVGuse(W.id+"content",LeftGraphBoundary(i),UpperGraphBoundary(i),GraphWidth(i),GraphHeight(i),W.content,contentpx);
    DrawGraphGrid(i);
    var a=(W.maxX-W.minX)/(W.ShowWindowMaxX-W.ShowWindowMinX);
    var d=(W.maxY-W.minY)/(W.ShowWindowMaxY-W.ShowWindowMinY);
    var e=-(W.ShowWindowMinX-W.minX)/(W.maxX-W.minX)*(GraphWidth(i))/a;
    var f=(W.ShowWindowMaxY-W.maxY)/(W.maxY-W.minY)*(GraphHeight(i))/d;
    var A=GraphWidth(i)/contentpx;
    var D=GraphHeight(i)/contentpx;
    var E=LeftGraphBoundary(i);
    var F=UpperGraphBoundary(i);
    m="matrix(" + A + ",0,0," + D + "," + E + "," + F + ") matrix(" + a + ",0,0," + d + "," + e + "," + f + ")";
    hm.setAttributeNS(null,"transform",m);
    //  hm.setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");
}
function DrawHeatMapMinimized(i) {
    var W=FSMinimizedWindowList[i];
    SVGrect(W.id+"rect",0,config_minimized_line_y+i*TILE,TILE,TILE);
    SVGuse(W.id+"content",0,config_minimized_line_y+i*TILE,TILE,TILE,W.content,785.0);
}
var spanX,spanY;
function DrawConfigMinimized(i) {}
function DrawSweepMinimized(i) {
    var W=FSMinimizedWindowList[i];
    var j;
    var data=W.content.split(",")
    var graph_rootX=0;
    var graph_width=TILE;
    var graph_rootY=config_minimized_line_y+TILE+i*TILE;
    var graph_height=TILE;
    var index=0;
    var prevX=NaN;
    var prevY=NaN;
    spanX=W.maxX-W.minX;
    spanY=W.maxY-W.minY;
    SVGrect(W.id+"rect",0,config_minimized_line_y+i*TILE,TILE,TILE);
    for (j=0;j<data.length;j++) {
        var SampleX=GetCircuitValue(data[j],W.xaxis);
        var SampleY=GetCircuitValue(data[j],W.yaxis);
        var X=Math.trunc(graph_rootX+1.0*(SampleX-W.minX)*graph_width/spanX);
        var Y=Math.trunc(graph_rootY-1.0*(SampleY-W.minY)*graph_height/spanY);
        if (!isNaN(prevX)) SVGline(W.id+"line"+index,prevX,prevY,X,Y);
        prevX=X;
        prevY=Y;
        index++;
    } 
}


// General-purpose grid drawing
function DrawGraphGrid(i) {
    var W=FSWindowList[i];
    var minX=W.ShowWindowMinX;
    var maxX=W.ShowWindowMaxX;
    var minY=W.ShowWindowMinY;
    var maxY=W.ShowWindowMaxY;
    graph_rootX=LeftGraphBoundary(i);
    graph_width=GraphWidth(i);
    graph_rootY=LowerGraphBoundary(i);
    graph_height=GraphHeight(i);
    SVGrect(W.id+"graph_frame",graph_rootX,graph_rootY-graph_height,graph_width,graph_height);
    SVGclip(W.id,graph_rootX,graph_rootY-graph_height,graph_width,graph_height);
    var id=W.id;
    var frameW=graph_width/(config_frame-2);
    var frameH=graph_height/(config_frame-2);
    var xtitle=SVGtext(id+"graph_xtitle",W.xtitle,graph_rootX+graph_width/2,W.y+TILE+1.9*frameH+graph_height,frameH/2,graph_width,0.8*frameH);
    xtitle.setAttributeNS(null,"text-anchor","middle");
    var ytitle=SVGtext(id+"graph_ytitle",W.ytitle,0,0,frameW/2,graph_height,0.4*frameW);
    ytitle.setAttributeNS(null,"text-anchor","middle");
    var ytitle_e=W.x+0.1*frameW;
    var ytitle_f=W.y+TILE+frameH+graph_height/2;
    ytitle.setAttributeNS(null,"transform","matrix(0,1,-1,0,"+ytitle_e+","+ytitle_f+")");
    spanX=parseFloat(maxX)-parseFloat(minX);
    spanY=parseFloat(maxY)-parseFloat(minY);
    //   Calculate optimal grid
    var stepX=Math.pow(10,Math.trunc(Math.log10(spanX)))*10;
    while (spanX/stepX<4) {
        if (2*spanX/stepX>=4) {stepX=stepX/2; break;}
        if (5*spanX/stepX>=4) {stepX=stepX/5; break;}
        stepX=stepX/10;
    }
    var stepY=Math.pow(10,Math.trunc(Math.log10(spanY)))*10;
    while (spanY/stepY<4) {
        if (2*spanY/stepY>=4) {stepY=stepY/2; break;}
        if (5*spanY/stepY>=4) {stepY=stepY/5; break;}
        stepY=stepY/10;
    }
    var startX=Math.trunc(minX/stepX)*stepX;
    if (minX<0) startX=startX-stepX;
    while (startX<minX) startX=startX+stepX;
    
    var startY=Math.trunc(minY/stepY)*stepY;
    if (minY<0) startY=startY-stepY;
    while (startY<minY) startY=startY+stepY;
    var endX=Math.trunc(maxX/stepX)*stepX;
    while (endX<maxX) endX=endX+stepX;
    var endY=Math.trunc(maxY/stepY)*stepY;
    while (endY<maxY) endY=endY+stepY;
    // Plot grid
    var gridX,gridY;
    var index=0;
    gridY=Math.trunc(graph_rootY-graph_height);
    var width_limit=0.8*graph_width/((maxX-startX)/stepX);
    var height_limit=0.4*frameH;
    for (gridX=startX;gridX<=maxX;gridX=gridX+stepX) {
        var X=Math.trunc(graph_rootX+1.0*(gridX-minX)*graph_width/spanX);
        var line=SVGline(id+"xgrid"+index,X,graph_rootY+frameH/10,X,gridY);
        if (gridX!=0) line.setAttributeNS(null,"stroke-dasharray","5,5");
        var num=SVGnum(id+"xgrid_num"+index,eng(gridX),X,graph_rootY+frameH/2,frameH/2,width_limit,height_limit);
        num.setAttributeNS(null,"text-anchor","middle");
        index++;
    }
    width_limit=0.4*frameW;
    height_limit=0.8*graph_height/((maxY-startY)/stepY);
    gridX=Math.trunc(graph_rootX+graph_width);
    for (gridY=startY;gridY<=maxY;gridY=gridY+stepY) {
        var Y=Math.trunc(graph_rootY-1.0*(gridY-minY)*graph_height/spanY);
        var line=SVGline(id+"ygrid"+index,graph_rootX-frameW/10,Y,gridX,Y);
        if (gridY!=0) line.setAttributeNS(null,"stroke-dasharray","5,5");
        var num=SVGnum(id+"ygrid_num"+index,eng(gridY),W.x+0.5*frameW,Y+frameH/5,frameH/2,width_limit,height_limit);
        index++;
    }
    W.ShowWindowMinX=minX;
    W.ShowWindowMaxX=maxX;
    W.ShowWindowMinY=minY;
    W.ShowWindowMaxY=maxY;
    FSWindowList[i]=W;
}
function InitSweep(i) {
    var W=FSWindowList[i];
    W.xtitle=W.xaxis+"   ["+unit_Map[W.xaxis]+"]";
    W.ytitle=W.yaxis+"   ["+unit_Map[W.yaxis]+"]";
    var data=W.content.split(",")
    W.minX=GetCircuitValue(data[0],W.xaxis);
    W.minY=GetCircuitValue(data[0],W.yaxis);
    W.maxX=GetCircuitValue(data[0],W.xaxis);
    W.maxY=GetCircuitValue(data[0],W.yaxis);
    var j;
    for (j=0;j<data.length;j++) {
        var SampleX=GetCircuitValue(data[j],W.xaxis);
        var SampleY=GetCircuitValue(data[j],W.yaxis);
        if (parseFloat(SampleX)<W.minX) W.minX=SampleX;
        if (parseFloat(SampleX)>W.maxX) W.maxX=SampleX;
        if (parseFloat(SampleY)<W.minY) W.minY=SampleY;
        if (parseFloat(SampleY)>W.maxY) W.maxY=SampleY;
    }
    var spanX=parseFloat(W.maxX)-parseFloat(W.minX);
    var spanY=parseFloat(W.maxY)-parseFloat(W.minY);
    W.ShowWindowMinX=parseFloat(W.minX)-0.05*parseFloat(spanX);
    W.ShowWindowMaxX=parseFloat(W.maxX)+0.05*parseFloat(spanX);
    W.ShowWindowMinY=parseFloat(W.minY)-0.05*parseFloat(spanY);
    W.ShowWindowMaxY=parseFloat(W.maxY)+0.05*parseFloat(spanY);
    FSWindowList[i]=W;
}
function GetCircuitIndex(id) {
    var i;
    for (i=0;i<circuit_list.length;i++) {
        if (circuit_list[i].id!=id) continue;
        return i;
    }
}
function GetCircuitValue(id,attr) {
    return circuit_list[GetCircuitIndex(id)][attr];
}
function DrawConfig(i) {
    var W=FSWindowList[i];
    var HTML=SVGhtml(W.id+"FloatingConfigurations",W.x,W.y+TILE,500,500,W.content);
    if ((htmlWidth!=W.w)||(htmlHeight!=W.h)) {
        W.h=htmlHeight;
        W.w=htmlWidth;
        FSWindowList[i]=W;
        Redraw();
    }
}
function DrawSweep(i) {
    var W=FSWindowList[i];
    var data=W.content.split(",");
    DrawGraphGrid(i,20);
    var index=0;
    var X8,Y8,X4,Y4,X0,Y0;
    var pass8,pass4,pass0;
    var j;
    for (j=0;j<data.length;j++) {
        var SampleX=GetCircuitValue(data[j],W.xaxis);
        var SampleY=GetCircuitValue(data[j],W.yaxis);
        X8=Math.trunc(graph_rootX+1.0*(SampleX-W.ShowWindowMinX)*graph_width/spanX);
        Y8=Math.trunc(graph_rootY-1.0*(SampleY-W.ShowWindowMinY)*graph_height/spanY);
        pass8="green";
        for (k=0;k<Object.keys(SPEC).length;k++) {
            var property=Object.keys(SPEC)[k];
            if (SPEC[property]=="") continue;
            var val=GetCircuitValue(data[j],property);
            if (property_quality[property]*val<property_quality[property]*SPEC[property]) {
                pass8="red";
                break;
            }
        }
        if (j==2) {
//            var X1=21*X0/32+14*X4/32-3*X8/32;
//            var Y1=21*Y0/32+14*Y4/32-3*Y8/32;
//            var X2=12*X0/32+24*X4/32-4*X8/32;
//            var Y2=12*Y0/32+24*Y4/32-4*Y8/32;
//            var X3=5*X0/32+30*X4/32-3*X8/32;
//            var Y3=5*Y0/32+30*Y4/32-3*Y8/32;
//            SVGgraphline(W.id+"line"+index++,X0,Y0,X1,Y1,pass0).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
//            SVGgraphline(W.id+"line"+index++,X2,Y2,X1,Y1,pass0).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
//            SVGgraphline(W.id+"line"+index++,X2,Y2,X3,Y3,pass4).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
//            SVGgraphline(W.id+"line"+index++,X4,Y4,X3,Y3,pass4).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
            SVGgraphline(W.id+"line"+index++,X4,Y4,X0,Y0,pass4).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
        }
        if (j>=2) {
//            var X7=21*X8/32+14*X4/32-3*X0/32;
//            var Y7=21*Y8/32+14*Y4/32-3*Y0/32;
//            var X6=12*X8/32+24*X4/32-4*X0/32;
//            var Y6=12*Y8/32+24*Y4/32-4*Y0/32;
//            var X5=5*X8/32+30*X4/32-3*X0/32;
//            var Y5=5*Y8/32+30*Y4/32-3*Y0/32;
//            SVGgraphline(W.id+"line"+index++,X4,Y4,X5,Y5,pass4).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
//            SVGgraphline(W.id+"line"+index++,X6,Y6,X5,Y5,pass4).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
//            SVGgraphline(W.id+"line"+index++,X6,Y6,X7,Y7,pass8).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
//            SVGgraphline(W.id+"line"+index++,X8,Y8,X7,Y7,pass8).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
            SVGgraphline(W.id+"line"+index++,X8,Y8,X4,Y4,pass8).setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");;
        }
        X0=X4;
        Y0=Y4;
	pass0=pass4;
        X4=X8;
        Y4=Y8;
	pass4=pass8;
    }
    for (j=0;j<data.length;j++) {
        var SampleX=GetCircuitValue(data[j],W.xaxis);
        var SampleY=GetCircuitValue(data[j],W.yaxis);
        var X=Math.trunc(graph_rootX+1.0*(SampleX-W.ShowWindowMinX)*graph_width/spanX);
        var Y=Math.trunc(graph_rootY-1.0*(SampleY-W.ShowWindowMinY)*graph_height/spanY);
        var r=(W.w+W.h)/200.0;
        var pass="green";
        for (k=0;k<Object.keys(SPEC).length;k++) {
            var property=Object.keys(SPEC)[k];
            if (SPEC[property]=="") continue;
            var val=GetCircuitValue(data[j],property);
            if (property_quality[property]*val<property_quality[property]*SPEC[property]) {
                pass="red";
                break;
            }
        }
        var circ=SVGcirc(W.id+"marker"+index,X,Y,r);
        circ.setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");
        circ.setAttributeNS(null,"style","fill:"+pass);
        if (GetCircuitValue(data[j],"selected")) {
	    var x,y;
	    if (X-(W.x+W.w/config_frame)<TILE) {
	        x=X+3*r;
	    } else {
	        x=X-3*r;
	    }
	    if (Y-(W.y+2*TILE)<TILE) {
	        y=Y+3*r;
	    } else {
	        y=Y-3*r;
	    }
            var num=SVGtext(W.id+"num"+index,GetCircuitValue(data[j],"table_index"),x-r,y+1.5*r,5*r);
            num.setAttributeNS(null,"style","fill:"+pass);
            num.setAttributeNS(null,"clip-path","url(#"+W.id+"_clip)");
        }
        index++;
    }    
}
// Window types: Search, HeatMap, Schematic, Sweep
function init() {	
    document.body.style.overflow = "hidden";    
    schema_window=document.getElementById("SchematicContainer");
    XMLparser=new DOMParser();
    if (window.ActiveXObject) { 
        xhr = new ActiveXObject ("Microsoft.XMLHTTP"); 
    } 
    else if (window.XMLHttpRequest) { 
        xhr = new XMLHttpRequest (); 
    } 
    SVG.setAttribute("height",screen.availHeight);
    SVG.setAttribute("width",screen.availHeight*4/3);
    screen_dividerX=screen.availHeight*4/3;
    screen_dividerY=300;
    hover_object=SVGtext("hover_object",HoverMessage,endX+TILE,endY+TILE);
    config_minimized_line_y=0;
    var W={id:"search", title:"",x:300,y:0,w:500,h:500,content:"",state:"normal",type:"Search"};
    FSWindowList.push(W);
    GetServerData("/windows.xml","Data");
}
function getClickPositionUp(e) {
    var parentPosition = getPosition(e.currentTarget);
    endX = e.clientX - parentPosition.x ;
    endY = e.clientY - parentPosition.y ;
    for (i = FSWindowList.length-1; i>=0; i--) {
        var W=FSWindowList[i];
        if (endX<W.x) continue;
        if (endX>W.x+W.w) continue;
        if (endY<W.y) continue;
        if (endY>W.y+W.h+TILE) continue;
        if (W.type=="Config") {
            drag=0;
            resizing=0;
            resizing_screen=0;
            dragging_window=-1;
            return;
        }
        break;
    }	
    if (zoomingXY|zoomingX|zoomingY) {
        SVG.removeChild(zoom_box);
        W=FSWindowList[zooming_window];
        // Zoom-out gesture detected first
        if ((zoomingXY)&&((endX<startX)||(endY<startY))) {
            FSWindowList[zooming_window].ShowWindowMaxX=W.maxX;
            FSWindowList[zooming_window].ShowWindowMinX=W.minX;
            FSWindowList[zooming_window].ShowWindowMaxY=W.maxY;
            FSWindowList[zooming_window].ShowWindowMinY=W.minY;
        } else {
            if (zoomingX|zoomingXY) {
                var start=W.ShowWindowMinX;
                var span=W.ShowWindowMaxX-W.ShowWindowMinX;
                FSWindowList[zooming_window].ShowWindowMaxX=(endX-(LeftGraphBoundary(i)))/(GraphWidth(i))*span+start;
                FSWindowList[zooming_window].ShowWindowMinX=(startX-(LeftGraphBoundary(i)))/(GraphWidth(i))*span+start;
            }
            if (zoomingY|zoomingXY) {
                var start=W.ShowWindowMinY;
                var span=W.ShowWindowMaxY-W.ShowWindowMinY;
                FSWindowList[zooming_window].ShowWindowMaxY=(endY-(UpperGraphBoundary(i)))/(GraphHeight(i))*span+start;
                FSWindowList[zooming_window].ShowWindowMinY=(startY-(UpperGraphBoundary(i)))/(GraphHeight(i))*span+start;
            }
        }
        // Send new window to server
        zoomingXY=0;
        zoomingX=0;
        zoomingY=0;
    }
    if (panningXY|panningX|panningY) {
        // Send new window to server
        panningXY=0;
        panningX=0;
        panningY=0;
    }
    // Debug tail, remove later
    if (debug_mode) {
        var xpos=document.getElementById("Xpos");
        xpos.innerHTML=endX;
        var ypos=document.getElementById("Ypos");
        ypos.innerHTML=endY;
        var bpos=document.getElementById("Button");
        bpos.innerHTML=e.buttons;
    }
    drag=0;
    resizing=0;
    resizing_screen=0;
    dragging_window=-1;
    Redraw();
}

function PhysicalX(i,X) {
    var W=FSWindowList[i];
    var retval=(X-LeftGraphBoundary(i))/(GraphWidth(i))*(W.ShowWindowMaxX-W.ShowWindowMinX)+W.ShowWindowMinX;
    return retval;
}
function PhysicalY(i,Y) {
    var W=FSWindowList[i];
    var retval=(Y-UpperGraphBoundary(i))/(GraphHeight(i))*(W.ShowWindowMaxY-W.ShowWindowMinY)+W.ShowWindowMinY;
    return retval;
}
function GraphicX(i,X) {
    var W=FSWindowList[i];
    var retval=LeftGraphBoundary(i)+GraphWidth(i)*(X-W.ShowWindowMinX)/(W.ShowWindowMaxX-W.ShowWindowMinX);
    return retval;
}
function GraphicY(i,Y) {
    var W=FSWindowList[i];
    var retval=UpperGraphBoundary(i)+GraphHeight(i)*(W.ShowWindowMaxY-Y)/(W.ShowWindowMaxY-W.ShowWindowMinY);
    return retval;
}
function MouseOverHeatMap(i) {
    var W=FSWindowList[i];
    if ((endX>LeftGraphBoundary(i))&&(endX<RightGraphBoundary(i))&&(endY>UpperGraphBoundary(i))&&(endY<LowerGraphBoundary(i))) SVG.style.cursor='crosshair';
}
function SenseClosestCircuit(i) {
    var W=FSWindowList[i];
    var rsquare=(W.w+W.h)/200.0;
    rsquare=rsquare*rsquare*2;
    var retval=-1;
    var data=W.content.split(",")
    var j;
    if ((endX>LeftGraphBoundary(i))&&(endX<RightGraphBoundary(i))&&(endY>UpperGraphBoundary(i))&&(endY<LowerGraphBoundary(i))) SVG.style.cursor='crosshair';
    for (j=0;j<data.length;j++) {
        var id=data[j];
        var X=GraphicX(i,GetCircuitValue(id,W.xaxis));
        var Y=GraphicY(i,GetCircuitValue(id,W.yaxis));
        var dist=(endY-Y)*(endY-Y)+(endX-X)*(endX-X);
        if (dist<=rsquare) {
            retval=id;
            break;
        }    
    }
    return retval;
}
function MouseOverSweep(i) {
    var id=SenseClosestCircuit(i)
    if (id==-1) return;
    var W=FSWindowList[i];        
    HoverMessage=eng(GetCircuitValue(id,W.xaxis))+","+eng(GetCircuitValue(id,W.yaxis));
}
function MouseOverSearch(i) {
    SVG.style.cursor='pointer';
}

function getMove(e) {
    var parentPosition = getPosition(e.currentTarget);
    endX = e.clientX - parentPosition.x ;
    endY = e.clientY - parentPosition.y ;
    if (zoomingXY) {
        var W=FSWindowList[zooming_window];
        if (endX<RightGraphBoundary(i)) zoom_box.setAttribute("width",endX-startX);
        if (endY<LowerGraphBoundary(i)) zoom_box.setAttribute("height",endY-startY);
    }
    if (zoomingX) {
        var W=FSWindowList[zooming_window];
        if (endX<LeftGraphBoundary(i)) zoom_box.setAttribute("width",endX-startX);
    }	
    if (zoomingY) {
        var W=FSWindowList[zooming_window];
        if (endY<LowerGraphBoundary(i)) zoom_box.setAttribute("height",endY-startY); 
    }	
    if (panningXY|panningX|panningY) {
        W=FSWindowList[panning_window];
        if (panningX|panningXY) {
            var span=W.ShowWindowMaxX-W.ShowWindowMinX;
            var step=(endX-startX)/(GraphWidth(i))*span;
            FSWindowList[panning_window].ShowWindowMaxX=panning_window_maxX-step;
            FSWindowList[panning_window].ShowWindowMinX=panning_window_minX-step;
        }
        if (panningY|panningXY) {
            var span=W.ShowWindowMaxY-W.ShowWindowMinY;
            var step=(-endY+startY)/(GraphHeight(i))*span;
            FSWindowList[panning_window].ShowWindowMaxY=panning_window_maxY-step;
            FSWindowList[panning_window].ShowWindowMinY=panning_window_minY-step;
        }
        Redraw();
        return;
    }	
    if (resizing_screen) {
        screen_dividerX=resizing_screenX-(endY-startY);
        screen_dividerY=resizing_screenY+(endY-startY);
        Redraw();
        return;
    }
    if (resizing) {
        var W=FSWindowList[resizing_window];
        W.w=resizingW+(endX-startX);
        W.h=resizingH+(endY-startY);
        Redraw();
        return;
    }
    HoverMessage="";
    SVG.style.cursor='default';
    for (i = 0; i < FSMinimizedWindowList.length; i++) {
        if (endX>TILE) continue;
        if (endY>TILE*(i+1)+config_minimized_line_y) continue;
        if (endY<TILE*i+config_minimized_line_y) continue;
        var W=FSMinimizedWindowList[i];
        HoverMessage=W.title;
    }	
    for (i = FSWindowList.length-1; i>=0; i--) { 
        var W=FSWindowList[i];
        if (endX<W.x) continue;
        if (endX>W.x+W.w) continue;
        if (endY<W.y) continue;
        if (endY>W.y+W.h+TILE) continue;
        //	if (W.type=="Config") return;
        if ((endY>W.y+W.h)&&(endX>W.x+W.w-TILE)) {
            SVG.style.cursor='se-resize';
            break;
        }
        eval("MouseOver"+W.type+"("+i+")");
        break;
    }	
    hover_object.setAttribute("x",endX+TILE);
    hover_object.setAttribute("y",endY+TILE);
    var bbox=hover_object.getBBox();
    hover_bg.setAttribute("x",bbox.x-bbox.width*0.05);
    hover_bg.setAttribute("y",bbox.y);
    hover_bg.setAttribute("width",bbox.width*1.1);
    hover_bg.setAttribute("height",bbox.height*1.1);
    hover_object.textContent=HoverMessage;
    
    if (debug_mode) {
        var xpos=document.getElementById("Xpos");
        xpos.innerHTML=endX+" "+zoomingXY+" "+zoomingX+" "+zoomingY;
        var ypos=document.getElementById("Ypos");
        ypos.innerHTML=endY;
    }
    if (dragging_window!=-1) {
        var W=FSWindowList[dragging_window];
        PositionWindow(dragging_window,dragging_windowX+endX-startX,dragging_windowY+endY-startY,W.w,W.h);
        return;
    }
    if (drag==0) return;
    if ((endY-startY<10)&&(endX-startX<10)) return;
    var bpos=document.getElementById("Button");
}


function getPosition(element) {
    var xPosition = 0;
    var yPosition = 0;
    while (element) {
        xPosition += (element.offsetLeft - element.scrollLeft + element.clientLeft);
        yPosition += (element.offsetTop - element.scrollTop + element.clientTop);
        element = element.offsetParent;
    }
    return { x: xPosition, y: yPosition };
}

function updateScroll() {
    var parentPosition = getPosition(e.currentTarget);
    var xPosition = e.clientX - parentPosition.x ;
    var yPosition = e.clientY - parentPosition.y ;
    var ypos=document.getElementById("Scroll");
    scroll=scroll+1;
    ypos.innerHTML=scroll;
}
</script>
<div id="XML_Data"></div>
<script>
init();
</script>
</body>
</html>
